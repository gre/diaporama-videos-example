!function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return o(r?r:e)},f,f.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e){return this instanceof o?(this.length=0,this.parent=void 0,"number"==typeof e?i(this,e):"string"==typeof e?s(this,e,arguments.length>1?arguments[1]:"utf8"):a(this,e)):arguments.length>1?new o(e,arguments[1]):new o(e)}function i(e,t){if(e=p(e,0>t?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;t>r;r++)e[r]=0;return e}function s(e,t,r){("string"!=typeof r||""===r)&&(r="utf8");var n=0|m(t,r);return e=p(e,n),e.write(t,r),e}function a(e,t){if(o.isBuffer(t))return l(e,t);if(H(t))return u(e,t);if(null==t)throw new TypeError("must start with number, buffer, array or string");return"undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer?f(e,t):t.length?c(e,t):h(e,t)}function l(e,t){var r=0|d(t.length);return e=p(e,r),t.copy(e,0,0,r),e}function u(e,t){var r=0|d(t.length);e=p(e,r);for(var n=0;r>n;n+=1)e[n]=255&t[n];return e}function f(e,t){var r=0|d(t.length);e=p(e,r);for(var n=0;r>n;n+=1)e[n]=255&t[n];return e}function c(e,t){var r=0|d(t.length);e=p(e,r);for(var n=0;r>n;n+=1)e[n]=255&t[n];return e}function h(e,t){var r,n=0;"Buffer"===t.type&&H(t.data)&&(r=t.data,n=0|d(r.length)),e=p(e,n);for(var o=0;n>o;o+=1)e[o]=255&r[o];return e}function p(e,t){o.TYPED_ARRAY_SUPPORT?e=o._augment(new Uint8Array(t)):(e.length=t,e._isBuffer=!0);var r=0!==t&&t<=o.poolSize>>>1;return r&&(e.parent=W),e}function d(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function g(e,t){if(!(this instanceof g))return new g(e,t);var r=new o(e,t);return delete r.parent,r}function m(e,t){"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return r;case"utf8":case"utf-8":return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(n)return M(e).length;t=(""+t).toLowerCase(),n=!0}}function v(e,t,r){var n=!1;if(t=0|t,r=void 0===r||r===1/0?this.length:0|r,e||(e="utf8"),0>t&&(t=0),r>this.length&&(r=this.length),t>=r)return"";for(;;)switch(e){case"hex":return S(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return A(this,t,r);case"binary":return D(this,t,r);case"base64":return T(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n),n>o&&(n=o)):n=o;var i=t.length;if(i%2!==0)throw new Error("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;n>s;s++){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");e[r+s]=a}return s}function y(e,t,r,n){return Z(M(t,e.length-r),e,r,n)}function b(e,t,r,n){return Z(z(t),e,r,n)}function x(e,t,r,n){return b(e,t,r,n)}function w(e,t,r,n){return Z(G(t),e,r,n)}function E(e,t,r,n){return Z(V(t,e.length-r),e,r,n)}function T(e,t,r){return 0===t&&r===e.length?Y.fromByteArray(e):Y.fromByteArray(e.slice(t,r))}function C(e,t,r){var n="",o="";r=Math.min(e.length,r);for(var i=t;r>i;i++)e[i]<=127?(n+=q(o)+String.fromCharCode(e[i]),o=""):o+="%"+e[i].toString(16);return n+q(o)}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;r>o;o++)n+=String.fromCharCode(127&e[o]);return n}function D(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;r>o;o++)n+=String.fromCharCode(e[o]);return n}function S(e,t,r){var n=e.length;(!t||0>t)&&(t=0),(!r||0>r||r>n)&&(r=n);for(var o="",i=t;r>i;i++)o+=U(e[i]);return o}function R(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function F(e,t,r){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(t>i||s>t)throw new RangeError("value is out of bounds");if(r+n>e.length)throw new RangeError("index out of range")}function L(e,t,r,n){0>t&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);i>o;o++)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function N(e,t,r,n){0>t&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);i>o;o++)e[r+o]=t>>>8*(n?o:3-o)&255}function P(e,t,r,n,o,i){if(t>o||i>t)throw new RangeError("value is out of bounds");if(r+n>e.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function B(e,t,r,n,o){return o||P(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(e,t,r,n,23,4),r+4}function k(e,t,r,n,o){return o||P(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(e,t,r,n,52,8),r+8}function O(e){if(e=j(e).replace(Q,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function j(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function U(e){return 16>e?"0"+e.toString(16):e.toString(16)}function M(e,t){t=t||1/0;for(var r,n=e.length,o=null,i=[],s=0;n>s;s++){if(r=e.charCodeAt(s),r>55295&&57344>r){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(56320>r){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=o-55296<<10|r-56320|65536,o=null}else o&&((t-=3)>-1&&i.push(239,191,189),o=null);if(128>r){if((t-=1)<0)break;i.push(r)}else if(2048>r){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(65536>r){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function z(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t}function V(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);s++)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}function G(e){return Y.toByteArray(O(e))}function Z(e,t,r,n){for(var o=0;n>o&&!(o+r>=t.length||o>=e.length);o++)t[o+r]=e[o];return o}function q(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}var Y=e("base64-js"),X=e("ieee754"),H=e("is-array");r.Buffer=o,r.SlowBuffer=g,r.INSPECT_MAX_BYTES=50,o.poolSize=8192;var W={};o.TYPED_ARRAY_SUPPORT=function(){function e(){}try{var t=new ArrayBuffer(0),r=new Uint8Array(t);return r.foo=function(){return 42},r.constructor=e,42===r.foo()&&r.constructor===e&&"function"==typeof r.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}(),o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);s>i&&e[i]===t[i];)++i;return i!==s&&(r=e[i],n=t[i]),n>r?-1:r>n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!H(e))throw new TypeError("list argument must be an Array of Buffers.");if(0===e.length)return new o(0);if(1===e.length)return e[0];var r;if(void 0===t)for(t=0,r=0;r<e.length;r++)t+=e[r].length;var n=new o(t),i=0;for(r=0;r<e.length;r++){var s=e[r];s.copy(n,i),i+=s.length}return n},o.byteLength=m,o.prototype.length=void 0,o.prototype.parent=void 0,o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):v.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?0:o.compare(this,e)},o.prototype.indexOf=function(e,t){function r(e,t,r){for(var n=-1,o=0;r+o<e.length;o++)if(e[r+o]===t[-1===n?0:o-n]){if(-1===n&&(n=o),o-n+1===t.length)return r+n}else n=-1;return-1}if(t>2147483647?t=2147483647:-2147483648>t&&(t=-2147483648),t>>=0,0===this.length)return-1;if(t>=this.length)return-1;if(0>t&&(t=Math.max(this.length+t,0)),"string"==typeof e)return 0===e.length?-1:String.prototype.indexOf.call(this,e,t);if(o.isBuffer(e))return r(this,e,t);if("number"==typeof e)return o.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,t):r(this,[e],t);throw new TypeError("val must be string, number or Buffer")},o.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},o.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t=0|t,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0);else{var o=n;n=t,t=0|r,r=o}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(0>r||0>t)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return y(this,e,t,r);case"ascii":return b(this,e,t,r);case"binary":return x(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),e>t&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=o._augment(this.subarray(e,t));else{var i=t-e;n=new o(i,void 0);for(var s=0;i>s;s++)n[s]=this[s+e]}return n.length&&(n.parent=this.parent||this),n},o.prototype.readUIntLE=function(e,t,r){e=0|e,t=0|t,r||F(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},o.prototype.readUIntBE=function(e,t,r){e=0|e,t=0|t,r||F(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},o.prototype.readUInt8=function(e,t){return t||F(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||F(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||F(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e=0|e,t=0|t,r||F(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e=0|e,t=0|t,r||F(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},o.prototype.readInt8=function(e,t){return t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||F(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||F(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||F(e,4,this.length),X.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||F(e,4,this.length),X.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||F(e,8,this.length),X.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||F(e,8,this.length),X.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){e=+e,t=0|t,r=0|r,n||I(this,e,t,r,Math.pow(2,8*r),0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){e=+e,t=0|t,r=0|r,n||I(this,e,t,r,Math.pow(2,8*r),0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e):L(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e):N(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e):N(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t=0|t,!n){var o=Math.pow(2,8*r-1);I(this,e,t,r,o-1,-o)}var i=0,s=1,a=0>e?1:0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=(e/s>>0)-a&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t=0|t,!n){var o=Math.pow(2,8*r-1);I(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0>e?1:0;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=(e/s>>0)-a&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e):L(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t=0|t,r||I(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e):N(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return k(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return k(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(1e3>i||!o.TYPED_ARRAY_SUPPORT)for(var s=0;i>s;s++)e[s+t]=this[s+r];else e._set(this.subarray(r,r+i),t);return i},o.prototype.fill=function(e,t,r){if(e||(e=0),t||(t=0),r||(r=this.length),t>r)throw new RangeError("end < start");if(r!==t&&0!==this.length){if(0>t||t>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof e)for(n=t;r>n;n++)this[n]=e;else{var o=M(e.toString()),i=o.length;for(n=t;r>n;n++)this[n]=o[n%i]}return this}},o.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(o.TYPED_ARRAY_SUPPORT)return new o(this).buffer;for(var e=new Uint8Array(this.length),t=0,r=e.length;r>t;t+=1)e[t]=this[t];return e.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var K=o.prototype;o._augment=function(e){return e.constructor=o,e._isBuffer=!0,e._set=e.set,e.get=K.get,e.set=K.set,e.write=K.write,e.toString=K.toString,e.toLocaleString=K.toString,e.toJSON=K.toJSON,e.equals=K.equals,e.compare=K.compare,e.indexOf=K.indexOf,e.copy=K.copy,e.slice=K.slice,e.readUIntLE=K.readUIntLE,e.readUIntBE=K.readUIntBE,e.readUInt8=K.readUInt8,e.readUInt16LE=K.readUInt16LE,e.readUInt16BE=K.readUInt16BE,e.readUInt32LE=K.readUInt32LE,e.readUInt32BE=K.readUInt32BE,e.readIntLE=K.readIntLE,e.readIntBE=K.readIntBE,e.readInt8=K.readInt8,e.readInt16LE=K.readInt16LE,e.readInt16BE=K.readInt16BE,e.readInt32LE=K.readInt32LE,e.readInt32BE=K.readInt32BE,e.readFloatLE=K.readFloatLE,e.readFloatBE=K.readFloatBE,e.readDoubleLE=K.readDoubleLE,e.readDoubleBE=K.readDoubleBE,e.writeUInt8=K.writeUInt8,e.writeUIntLE=K.writeUIntLE,e.writeUIntBE=K.writeUIntBE,e.writeUInt16LE=K.writeUInt16LE,e.writeUInt16BE=K.writeUInt16BE,e.writeUInt32LE=K.writeUInt32LE,e.writeUInt32BE=K.writeUInt32BE,e.writeIntLE=K.writeIntLE,e.writeIntBE=K.writeIntBE,e.writeInt8=K.writeInt8,e.writeInt16LE=K.writeInt16LE,e.writeInt16BE=K.writeInt16BE,e.writeInt32LE=K.writeInt32LE,e.writeInt32BE=K.writeInt32BE,e.writeFloatLE=K.writeFloatLE,e.writeFloatBE=K.writeFloatBE,e.writeDoubleLE=K.writeDoubleLE,e.writeDoubleBE=K.writeDoubleBE,e.fill=K.fill,e.inspect=K.inspect,e.toArrayBuffer=K.toArrayBuffer,e};var Q=/[^+\/0-9A-z\-]/g},{"base64-js":2,ieee754:3,"is-array":4}],2:[function(e,t,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===s||t===c?62:t===a||t===h?63:l>t?-1:l+10>t?t-l+26+26:f+26>t?t-f:u+26>t?t-u+26:void 0}function r(e){function r(e){u[c++]=e}var n,o,s,a,l,u;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=e.length;l="="===e.charAt(f-2)?2:"="===e.charAt(f-1)?1:0,u=new i(3*e.length/4-l),s=l>0?e.length-4:e.length;var c=0;for(n=0,o=0;s>n;n+=4,o+=3)a=t(e.charAt(n))<<18|t(e.charAt(n+1))<<12|t(e.charAt(n+2))<<6|t(e.charAt(n+3)),r((16711680&a)>>16),r((65280&a)>>8),r(255&a);return 2===l?(a=t(e.charAt(n))<<2|t(e.charAt(n+1))>>4,r(255&a)):1===l&&(a=t(e.charAt(n))<<10|t(e.charAt(n+1))<<4|t(e.charAt(n+2))>>2,r(a>>8&255),r(255&a)),u}function o(e){function t(e){return n.charAt(e)}function r(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var o,i,s,a=e.length%3,l="";for(o=0,s=e.length-a;s>o;o+=3)i=(e[o]<<16)+(e[o+1]<<8)+e[o+2],l+=r(i);switch(a){case 1:i=e[e.length-1],l+=t(i>>2),l+=t(i<<4&63),l+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],l+=t(i>>10),l+=t(i>>4&63),l+=t(i<<2&63),l+="="}return l}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),l="0".charCodeAt(0),u="a".charCodeAt(0),f="A".charCodeAt(0),c="-".charCodeAt(0),h="_".charCodeAt(0);e.toByteArray=r,e.fromByteArray=o}("undefined"==typeof r?this.base64js={}:r)},{}],3:[function(e,t,r){r.read=function(e,t,r,n,o){var i,s,a=8*o-n-1,l=(1<<a)-1,u=l>>1,f=-7,c=r?o-1:0,h=r?-1:1,p=e[t+c];for(c+=h,i=p&(1<<-f)-1,p>>=-f,f+=a;f>0;i=256*i+e[t+c],c+=h,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+e[t+c],c+=h,f-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,n),i-=u}return(p?-1:1)*s*Math.pow(2,i-n)},r.write=function(e,t,r,n,o,i){var s,a,l,u=8*i-o-1,f=(1<<u)-1,c=f>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,g=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),t+=s+c>=1?h/l:h*Math.pow(2,1-c),t*l>=2&&(s++,l/=2),s+c>=f?(a=0,s=f):s+c>=1?(a=(t*l-1)*Math.pow(2,o),s+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;e[r+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[r+p]=255&s,p+=d,s/=256,u-=8);e[r+p-d]|=128*g}},{}],4:[function(e,t,r){var n=Array.isArray,o=Object.prototype.toString;t.exports=n||function(e){return!!e&&"[object Array]"==o.call(e)}},{}],5:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,i,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[e],a(r))return!1;if(o(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),l=1;n>l;l++)i[l-1]=arguments[l];r.apply(this,i)}else if(s(r)){for(n=arguments.length,i=new Array(n-1),l=1;n>l;l++)i[l-1]=arguments[l];for(u=r.slice(),n=u.length,l=0;n>l;l++)u[l].apply(this,i)}return!0},n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var r;r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,i,a;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],i=r.length,n=-1,r===t||o(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(r)){for(a=i;a-->0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],o(r))this.removeListener(e,r);else for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var r;return r=e._events&&e._events[t]?o(e._events[t])?1:e._events[t].length:0}},{}],6:[function(e,t,r){function n(){f=!1,a.length?u=a.concat(u):c=-1,u.length&&o()}function o(){if(!f){var e=setTimeout(n);f=!0;for(var t=u.length;t;){for(a=u,u=[];++c<t;)a[c].run();c=-1,t=u.length}a=null,f=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function s(){}var a,l=t.exports={},u=[],f=!1,c=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new i(e,t)),1!==u.length||f||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=s,l.addListener=s,l.once=s,l.off=s,l.removeListener=s,l.removeAllListeners=s,l.emit=s,l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],7:[function(e,t,r){t.exports={timeline:[{slide2d:{background:"#ce7",size:[800,600],draws:[{font:"bold 80px sans-serif",fillStyle:"#fff",textBaseline:"bottom",textAlign:"center"},["fillText","greweb's Garden",400,300,48],{font:"italic 30px sans-serif",fillStyle:"#fff",textBaseline:"bottom",textAlign:"center"},["fillText","a showcase for Diaporama library",400,580,48]]},duration:1e3,transitionNext:{duration:1e3}},{image:"garden/semis.jpg",duration:3e3,kenburns:{from:[.7,[.5,.4]],to:[1,[.5,.5]],easing:[.1,0,.5,1]},transitionNext:{duration:1e3,name:"CrossZoom"}},{image:"garden/po-melon_mise_en_terre.jpg",duration:2e3,kenburns:{from:[.6,[.5,1]],to:[1,[.5,1]],easing:[.2,0,.5,1]},transitionNext:{duration:1e3,name:"burn"}},{image:"garden/tout_en_terre.jpg",duration:4e3,kenburns:{from:[1,[1,.5]],to:[.5,[.3,.4]],easing:[0,0,.8,1]},transitionNext:{duration:1e3,name:"DoomScreenTransition"}},{slide2d:{background:"#ce7",size:[800,600],draws:[["drawImage","garden/tomates.jpg",0,0,800,600],{font:"bold 80px sans-serif",fillStyle:"#000",textBaseline:"top",textAlign:"center"},["fillText","Tomatoes",400,10]]},duration:2e3,transitionNext:{duration:2e3,name:"swap"}},{image:"garden/tomates_2.jpg",duration:200,transitionNext:{duration:2e3,name:"morph"}},{video:"garden/tomates_zoom",duration:2500,transitionNext:{duration:1500,name:"cube"}},{image:"garden/salades_a_repiquer.jpg",duration:2e3,transitionNext:{duration:2e3,name:"Mosaic"}},{image:"garden/salades_developpes.jpg",duration:2500,kenburns:{from:[.8,[.5,.4]],to:[1,[.5,.6]],easing:[.3,0,.8,1]},transitionNext:{duration:1e3,name:"burn"}},{video:"garden/salades_vue_ensemble",duration:8e3,transitionNext:{duration:2e3,name:"flash"}},{video:"garden/concombre-chinois_zoom",duration:5e3,transitionNext:{duration:1e3}},{video:"garden/po-melon_zoom",duration:16e3,transitionNext:{duration:1e3}},{slide2d:{background:"#ce7",size:[800,600],draws:[["drawImage","garden/po-melon.jpg",0,-300,800,1066],{font:"bold 80px sans-serif",fillStyle:"#fff",textBaseline:"top",textAlign:"center"},["fillText","Do you know this?",400,10],{font:"normal 80px sans-serif",textBaseline:"bottom"},["fillText","蒲瓜 aka 'Po Melon'",400,590]]},duration:4e3,transitionNext:{duration:2e3}},{video:"garden/po-melon_vue_ensemble",duration:18e3,transitionNext:{duration:1e3}},{slide2d:{background:"#ce7",size:[800,600],draws:[["drawImage","garden/po-melon_aggripe.jpg",0,-300,800,1066],{font:"bold 64px sans-serif",fillStyle:"#fff",textBaseline:"top"},["fillText","it hooks\nall the things !",30,340,100]]},duration:3e3,transitionNext:{duration:1e3}},{video:"garden/po-melon_aggripe",duration:26e3,kenburns:{from:[1,[.5,.5]],to:[1,[.5,.2]]},transitionNext:{duration:1e3,name:"doorway"}},{image:"garden/po-melon_pese.jpg",duration:4e3,kenburns:{from:[.9,[.5,.2]],to:[1,[.5,.8]],easing:[0,0,.3,0]},transitionNext:{duration:1e3,name:"ripple"}},{image:"garden/choux_chinois_cuisines.jpg",duration:4e3,transitionNext:{duration:1e3,name:"PageCurl"}},{image:"garden/legumes_cuisines.jpg",duration:4e3,transitionNext:{duration:1e3}},{slide2d:{background:"#ce7",size:[800,600],draws:[["drawImage","garden/kid.jpg",0,0,800,600],{font:"bold 80px sans-serif",fillStyle:"#fff",textBaseline:"top",textAlign:"center"},["fillText","Kid is having fun",400,10],{textBaseline:"bottom"},["fillText","with green beans!",400,590]]},duration:4e3,transitionNext:{duration:2e3}},{slide2d:{background:"#ce7",size:[800,600],draws:[{font:"bold 48px sans-serif",fillStyle:"#fff",textBaseline:"bottom",textAlign:"center"},["fillText","Create your own slideshows",400,300,48],{font:"italic 30px sans-serif",fillStyle:"#99f",textBaseline:"bottom",textAlign:"center"},["fillText","http://diaporama.glsl.io/",400,550,48]]},duration:1e4,transitionNext:{duration:4e3}}],resources:{"garden/tomates_zoom":{"video/mp4":"garden/tomates_zoom.mp4","video/webm":"garden/tomates_zoom.webm","video/png":"garden/tomates_zoom.png"},"garden/salades_vue_ensemble":{"video/mp4":"garden/salades_vue_ensemble.mp4","video/webm":"garden/salades_vue_ensemble.webm","video/png":"garden/salades_vue_ensemble.png"},"garden/concombre-chinois_zoom":{"video/mp4":"garden/concombre-chinois_zoom.mp4","video/webm":"garden/concombre-chinois_zoom.webm","video/png":"garden/concombre-chinois_zoom.png"},"garden/po-melon_zoom":{"video/mp4":"garden/po-melon_zoom.mp4","video/webm":"garden/po-melon_zoom.webm","video/png":"garden/po-melon_zoom.png"},"garden/po-melon_vue_ensemble":{"video/mp4":"garden/po-melon_vue_ensemble.mp4","video/webm":"garden/po-melon_vue_ensemble.webm","video/png":"garden/po-melon_vue_ensemble.png"},"garden/po-melon_aggripe":{"video/mp4":"garden/po-melon_aggripe.mp4","video/webm":"garden/po-melon_aggripe.webm","video/png":"garden/po-melon_aggripe.png"}}}},{}],8:[function(e,t,r){var n=e("diaporama"),o=e("glsl-transitions"),i=e("json-beautify"),s=e("./diaporama.json");s.transitions=o;var a=n(document.getElementById("diaporama"),s,{autoplay:!0,loop:!0,width:800,height:600});document.body.addEventListener("keydown",function(e){switch(e.which){case 37:a.prev();break;case 39:a.next();break;case 32:a.paused=!a.paused}}),window.diaporama=a,document.getElementById("data").innerHTML=i(s,null,2,80)},{"./diaporama.json":7,diaporama:12,"glsl-transitions":9,"json-beautify":11}],9:[function(e,t,r){t.exports=e("./transitions.min.json")},{"./transitions.min.json":10}],10:[function(e,t,r){t.exports=[{id:"1f6e25d1075bb82e21db",name:"Blur",owner:"giangchau92",uniforms:{size:0},html_url:"https://gist.github.com/1f6e25d1075bb82e21db",created_at:"2015-05-03T16:04:27Z",updated_at:"2015-07-08T02:52:12Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define QUALITY 32\n\n#define N 20\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float size;const float GOLDEN_ANGLE=2.399963229728653;vec4 blur(sampler2D t,vec2 c,float radius){vec4 sum=vec4(0.0);float q=float(QUALITY);for(int i=0;i<QUALITY;++i){float fi=float(i);float a=fi*GOLDEN_ANGLE;float r=sqrt(fi/q)*radius;vec2 p=c+r*vec2(cos(a),sin(a));sum+=texture2D(t,p);}return sum/q;}vec4 blur2(sampler2D t,vec2 p){vec4 sum=vec4(0.0);int count=0;vec2 delta=vec2(1.0,1.0)/resolution.xy;for(int i=-N;i<N;i++){for(int j=-N;j<N;j++){vec2 uv;uv.x=p.x+float(i)*delta.x;uv.y=p.y+float(j)*delta.y;sum+=texture2D(t,uv);count++;}}return sum/float(count);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=blur2(from,p);}"},{id:"1b4862e4e2050a3abebe",name:"glitch displace",owner:"mattdesl",uniforms:{},html_url:"https://gist.github.com/1b4862e4e2050a3abebe",created_at:"2015-01-15T19:48:03Z",updated_at:"2015-07-08T02:58:06Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;highp float random(vec2 co){highp float a=12.9898;highp float b=78.233;highp float c=43758.5453;highp float dt=dot(co.xy,vec2(a,b));highp float sn=mod(dt,3.14);return fract(sin(sn)*c);}float voronoi(in vec2 x){vec2 p=floor(x);vec2 f=fract(x);float res=8.0;for(float j=-1.;j<=1.;j++)for(float i=-1.;i<=1.;i++){vec2 b=vec2(i,j);vec2 r=b-f+random(p+b);float d=dot(r,r);res=min(res,d);}return sqrt(res);}vec2 displace(vec4 tex,vec2 texCoord,float dotDepth,float textureDepth,float strength){float b=voronoi(.003*texCoord+2.0);float g=voronoi(0.2*texCoord);float r=voronoi(texCoord-1.0);vec4 dt=tex*1.0;vec4 dis=dt*dotDepth+1.0-tex*textureDepth;dis.x=dis.x-1.0+textureDepth*dotDepth;dis.y=dis.y-1.0+textureDepth*dotDepth;dis.x*=strength;dis.y*=strength;vec2 res_uv=texCoord;res_uv.x=res_uv.x+dis.x-0.0;res_uv.y=res_uv.y+dis.y;return res_uv;}float ease1(float t){return t==0.0||t==1.0?t:t<0.5?+0.5*pow(2.0,(20.0*t)-10.0):-0.5*pow(2.0,10.0-(t*20.0))+1.0;}float ease2(float t){return t==1.0?t:1.0-pow(2.0,-10.0*t);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 color1=texture2D(from,p);vec4 color2=texture2D(to,p);vec2 disp=displace(color1,p,0.33,0.7,1.0-ease1(progress));vec2 disp2=displace(color2,p,0.33,0.5,ease2(progress));vec4 dColor1=texture2D(to,disp);vec4 dColor2=texture2D(from,disp2);float val=ease1(progress);vec3 gray=vec3(dot(min(dColor2,dColor1).rgb,vec3(0.299,0.587,0.114)));dColor2=vec4(gray,1.0);dColor2*=2.0;color1=mix(color1,dColor2,smoothstep(0.0,0.5,progress));color2=mix(color2,dColor1,smoothstep(1.0,0.5,progress));gl_FragColor=mix(color1,color2,val);}"
},{id:"04fd9a7de4012cbb03f6",name:"crosshatch",owner:"pthrasher",uniforms:{},html_url:"https://gist.github.com/04fd9a7de4012cbb03f6",created_at:"2014-12-17T03:04:51Z",updated_at:"2015-07-08T02:54:07Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;const vec2 center=vec2(0.5,0.5);float quadraticInOut(float t){float p=2.0*t*t;return t<0.5?p:-p+(4.0*t)-1.0;}float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;if(progress==0.0){gl_FragColor=texture2D(from,p);}else if(progress==1.0){gl_FragColor=texture2D(to,p);}else{float x=progress;float dist=distance(center,p);float r=x-min(rand(vec2(p.y,0.0)),rand(vec2(0.0,p.x)));float m=dist<=r?1.0:0.0;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),m);}}"},{id:"8e6226b215548ba12734",name:"undulating burn out",owner:"pthrasher",uniforms:{smoothness:.02},html_url:"https://gist.github.com/8e6226b215548ba12734",created_at:"2014-12-16T23:01:57Z",updated_at:"2015-07-08T02:53:17Z",stars:2,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define 	M_PI   3.14159265358979323846	/* pi */\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float smoothness;const vec2 center=vec2(0.5,0.5);float quadraticInOut(float t){float p=2.0*t*t;return t<0.5?p:-p+(4.0*t)-1.0;}float linearInterp(vec2 range,vec2 domain,float x){return mix(range.x,range.y,smoothstep(domain.x,domain.y,clamp(x,domain.x,domain.y)));}float getGradient(float r,float dist){float grad=smoothstep(-smoothness,0.0,r-dist*(1.0+smoothness));if(r-dist<0.005&&r-dist>-0.005){return -1.0;}else if(r-dist<0.01&&r-dist>-0.005){return -2.0;}return grad;}float round(float a){return floor(a+0.5);}float getWave(vec2 p){vec2 _p=p-center;float rads=atan(_p.y,_p.x);float degs=degrees(rads)+180.0;vec2 range=vec2(0.0,M_PI*30.0);vec2 domain=vec2(0.0,360.0);float ratio=(M_PI*30.0)/360.0;degs=degs*ratio;float x=progress;float magnitude=mix(0.02,0.09,smoothstep(0.0,1.0,x));float offset=mix(40.0,30.0,smoothstep(0.0,1.0,x));float ease_degs=quadraticInOut(sin(degs));float deg_wave_pos=(ease_degs*magnitude)*sin(x*offset);return x+deg_wave_pos;}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;if(progress==0.0){gl_FragColor=texture2D(from,p);}else if(progress==1.0){gl_FragColor=texture2D(to,p);}else{float dist=distance(center,p);float m=getGradient(getWave(p),dist);if(m==-2.0){gl_FragColor=mix(texture2D(from,p),vec4(0.0,0.0,0.0,1.0),0.75);}else{gl_FragColor=mix(texture2D(from,p),texture2D(to,p),m);}}}"},{id:"b3aa4a8b4f88dc228d4a",name:"test",owner:"brandonyoyo",uniforms:{},html_url:"https://gist.github.com/b3aa4a8b4f88dc228d4a",created_at:"2014-10-26T16:46:18Z",updated_at:"2015-07-08T02:58:46Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),progress);}"},{id:"d1f891c5585fc40b55ea",name:"Star Wipe",owner:"MemoryStomp",uniforms:{},html_url:"https://gist.github.com/d1f891c5585fc40b55ea",created_at:"2014-07-01T06:58:45Z",updated_at:"2015-07-08T02:54:47Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;vec2 circlePoint(float ang){ang+=6.28318*0.15;return vec2(cos(ang),sin(ang));}float cross2d(vec2 a,vec2 b){return (a.x*b.y-a.y*b.x);}float star(vec2 p,float size){if(size<=0.0){return 0.0;}p/=size;vec2 p0=circlePoint(0.0);vec2 p1=circlePoint(6.28318*1.0/5.0);vec2 p2=circlePoint(6.28318*2.0/5.0);vec2 p3=circlePoint(6.28318*3.0/5.0);vec2 p4=circlePoint(6.28318*4.0/5.0);float s0=(cross2d(p1-p0,p-p0));float s1=(cross2d(p2-p1,p-p1));float s2=(cross2d(p3-p2,p-p2));float s3=(cross2d(p4-p3,p-p3));float s4=(cross2d(p0-p4,p-p4));float s5=min(min(min(s0,s1),min(s2,s3)),s4);float s=max(1.0-sign(s0*s1*s2*s3*s4)+sign(s5),0.0);s=sign(2.6-length(p))*s;return max(s,0.0);}void main(){vec2 p=(gl_FragCoord.xy/resolution.xy);vec2 o=p*2.0-1.0;float t=progress*1.4;float c1=star(o,t);float c2=star(o,t-0.1);float border=max(c1-c2,0.0);gl_FragColor=mix(texture2D(from,p),texture2D(to,p),c1)+vec4(border,border,border,0.0);}"},{id:"5a4d1fb6711076d17e2e",name:"morph",owner:"paniq",uniforms:{},html_url:"https://gist.github.com/5a4d1fb6711076d17e2e",created_at:"2014-07-01T04:52:25Z",updated_at:"2015-07-08T02:59:00Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;const float strength=0.1;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 ca=texture2D(from,p);vec4 cb=texture2D(to,p);vec2 oa=(((ca.rg+ca.b)*0.5)*2.0-1.0);vec2 ob=(((cb.rg+cb.b)*0.5)*2.0-1.0);vec2 oc=mix(oa,ob,0.5)*strength;float w0=progress;float w1=1.0-w0;gl_FragColor=mix(texture2D(from,p+oc*w0),texture2D(to,p-oc*w1),progress);}"},{id:"00973cee8e0353c73305",name:"LumaWipe",owner:"rectalogic",uniforms:{lumaTex:"conical-asym.png",invertLuma:!0,softness:.25},html_url:"https://gist.github.com/00973cee8e0353c73305",created_at:"2014-06-17T02:11:27Z",updated_at:"2015-07-08T02:51:54Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform sampler2D lumaTex;uniform bool invertLuma;uniform float softness;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float luma=texture2D(lumaTex,p).x;if(invertLuma) luma=1.0-luma;vec4 fromColor=texture2D(from,p);vec4 toColor=texture2D(to,p);float time=mix(0.0,1.0+softness,progress);if(luma<=time-softness) gl_FragColor=toColor;else if(luma>=time) gl_FragColor=fromColor;else{float alpha=(time-luma)/softness;gl_FragColor=mix(fromColor,toColor,alpha);}}"},{id:"0141a38779af3a652c22",name:"simple luma",owner:"gre",uniforms:{luma:"spiral-1.png"},html_url:"https://gist.github.com/0141a38779af3a652c22",created_at:"2014-06-13T08:16:10Z",updated_at:"2015-07-08T02:50:23Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform sampler2D luma;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),step(texture2D(luma,p).r,progress));}"},{id:"ee15128c2b87d0e74dee",name:"cube",owner:"gre",uniforms:{persp:.7,unzoom:.3,reflection:.4,floating:3},html_url:"https://gist.github.com/ee15128c2b87d0e74dee",created_at:"2014-06-12T17:13:17Z",updated_at:"2015-07-08T02:53:47Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float persp;uniform float unzoom;uniform float reflection;uniform float floating;vec2 project(vec2 p){return p*vec2(1.0,-1.2)+vec2(0.0,-floating/100.);}bool inBounds(vec2 p){return all(lessThan(vec2(0.0),p))&&all(lessThan(p,vec2(1.0)));}vec4 bgColor(vec2 p,vec2 pfr,vec2 pto){vec4 c=vec4(0.0,0.0,0.0,1.0);pfr=project(pfr);if(inBounds(pfr)){c+=mix(vec4(0.0),texture2D(from,pfr),reflection*mix(1.0,0.0,pfr.y));}pto=project(pto);if(inBounds(pto)){c+=mix(vec4(0.0),texture2D(to,pto),reflection*mix(1.0,0.0,pto.y));}return c;}vec2 xskew(vec2 p,float persp,float center){float x=mix(p.x,1.0-p.x,center);return ((vec2(x,(p.y-0.5*(1.0-persp)*x)/(1.0+(persp-1.0)*x))-vec2(0.5-distance(center,0.5),0.0))*vec2(0.5/distance(center,0.5)*(center<0.5?1.0:-1.0),1.0)+vec2(center<0.5?0.0:1.0,0.0));}void main(){vec2 op=gl_FragCoord.xy/resolution.xy;float uz=unzoom*2.0*(0.5-distance(0.5,progress));vec2 p=-uz*0.5+(1.0+uz)*op;vec2 fromP=xskew((p-vec2(progress,0.0))/vec2(1.0-progress,1.0),1.0-mix(progress,0.0,persp),0.0);vec2 toP=xskew(p/vec2(progress,1.0),mix(pow(progress,2.0),1.0,persp),1.0);if(inBounds(fromP)){gl_FragColor=texture2D(from,fromP);}else if(inBounds(toP)){gl_FragColor=texture2D(to,toP);}else{gl_FragColor=bgColor(op,fromP,toP);}}"},{id:"9b99fc01fd5705008a5b",name:"Glitch Memories",owner:"niseh",uniforms:{},html_url:"https://gist.github.com/9b99fc01fd5705008a5b",created_at:"2014-05-29T19:32:52Z",updated_at:"2015-07-08T02:53:59Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void glitch_memories(sampler2D pic){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 block=floor(gl_FragCoord.xy/vec2(16));vec2 uv_noise=block/vec2(64);uv_noise+=floor(vec2(progress)*vec2(1200.0,3500.0))/vec2(64);float block_thresh=pow(fract(progress*1200.0),2.0)*0.2;float line_thresh=pow(fract(progress*2200.0),3.0)*0.7;vec2 red=p,green=p,blue=p,o=p;vec2 dist=(fract(uv_noise)-0.5)*0.3;red+=dist*0.1;green+=dist*0.2;blue+=dist*0.125;gl_FragColor.r=texture2D(pic,red).r;gl_FragColor.g=texture2D(pic,green).g;gl_FragColor.b=texture2D(pic,blue).b;gl_FragColor.a=1.0;}void main(void){float smoothed=smoothstep(0.,1.,progress);if((smoothed<0.4&&smoothed>0.1)){glitch_memories(from);}else if((smoothed>0.6&&smoothed<0.9)){glitch_memories(to);}else{vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),progress);}}"},{id:"fe67b3b5149738069537",name:"potleaf",owner:"Flexi23",uniforms:{},html_url:"https://gist.github.com/fe67b3b5149738069537",created_at:"2014-05-28T09:58:30Z",updated_at:"2015-07-08T02:52:45Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(){vec2 uv=gl_FragCoord.xy/resolution.xy;vec2 leaf_uv=(uv-vec2(0.5))/10./pow(progress,3.5);leaf_uv.y+=0.35;float r=0.18;float o=atan(leaf_uv.y,leaf_uv.x);gl_FragColor=mix(texture2D(from,uv),texture2D(to,uv),1.-step(1.-length(leaf_uv)+r*(1.+sin(o))*(1.+0.9*cos(8.*o))*(1.+0.1*cos(24.*o))*(0.9+0.05*cos(200.*o)),1.));}"},{id:"b86b90161503a0023231",name:"CrossZoom",owner:"rectalogic",uniforms:{strength:.4},html_url:"https://gist.github.com/b86b90161503a0023231",created_at:"2014-05-25T01:24:39Z",updated_at:"2015-07-08T02:53:57Z",stars:2,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float strength;const float PI=3.141592653589793;float Linear_ease(in float begin,in float change,in float duration,in float time){return change*time/duration+begin;}float Exponential_easeInOut(in float begin,in float change,in float duration,in float time){if(time==0.0) return begin;else if(time==duration) return begin+change;time=time/(duration/2.0);if(time<1.0) return change/2.0*pow(2.0,10.0*(time-1.0))+begin;return change/2.0*(-pow(2.0,-10.0*(time-1.0))+2.0)+begin;}float Sinusoidal_easeInOut(in float begin,in float change,in float duration,in float time){return -change/2.0*(cos(PI*time/duration)-1.0)+begin;}float random(in vec3 scale,in float seed){return fract(sin(dot(gl_FragCoord.xyz+seed,scale))*43758.5453+seed);}vec3 crossFade(in vec2 uv,in float dissolve){return mix(texture2D(from,uv).rgb,texture2D(to,uv).rgb,dissolve);}void main(){vec2 texCoord=gl_FragCoord.xy/resolution.xy;vec2 center=vec2(Linear_ease(0.25,0.5,1.0,progress),0.5);float dissolve=Exponential_easeInOut(0.0,1.0,1.0,progress);float strength=Sinusoidal_easeInOut(0.0,strength,0.5,progress);vec3 color=vec3(0.0);float total=0.0;vec2 toCenter=center-texCoord;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=0.0;t<=40.0;t++){float percent=(t+offset)/40.0;float weight=4.0*(percent-percent*percent);color+=crossFade(texCoord+toCenter*percent*strength,dissolve)*weight;total+=weight;}gl_FragColor=vec4(color/total,1.0);}"},{id:"ce9279de351984f0ad27",name:"Slide",owner:"rectalogic",uniforms:{translateX:1,translateY:0},html_url:"https://gist.github.com/ce9279de351984f0ad27",created_at:"2014-05-25T01:13:20Z",updated_at:"2015-07-08T02:50:33Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float translateX;uniform float translateY;void main(){vec2 texCoord=gl_FragCoord.xy/resolution.xy;float x=progress*translateX;float y=progress*translateY;if(x>=0.0&&y>=0.0){if(texCoord.x>=x&&texCoord.y>=y){gl_FragColor=texture2D(from,texCoord-vec2(x,y));}else{vec2 uv;if(x>0.0) uv=vec2(x-1.0,y);else if(y>0.0) uv=vec2(x,y-1.0);gl_FragColor=texture2D(to,texCoord-uv);}}else if(x<=0.0&&y<=0.0){if(texCoord.x<=(1.0+x)&&texCoord.y<=(1.0+y)) gl_FragColor=texture2D(from,texCoord-vec2(x,y));else{vec2 uv;if(x<0.0) uv=vec2(x+1.0,y);else if(y<0.0) uv=vec2(x,y+1.0);gl_FragColor=texture2D(to,texCoord-uv);}}else gl_FragColor=vec4(0.0);}"},{id:"154a99fbe5300fb5c279",name:"pinwheel",owner:"mrspeaker",uniforms:{},html_url:"https://gist.github.com/154a99fbe5300fb5c279",created_at:"2014-05-23T21:56:59Z",updated_at:"2015-07-08T02:58:23Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float circPos=atan(p.y-0.5,p.x-0.5)+progress;float modPos=mod(circPos,3.1415/4.);float signed=sign(progress-modPos);float smoothed=smoothstep(0.,1.,signed);if(smoothed>0.5){gl_FragColor=texture2D(to,p);}else{gl_FragColor=texture2D(from,p);}}"},{id:"e54a807cdb66c8b16a34",name:"Kaleidoscope",owner:"nwoeanhinnogaehr",uniforms:{speed:1,angle:2,power:2},html_url:"https://gist.github.com/e54a807cdb66c8b16a34",created_at:"2014-05-23T19:02:46Z",updated_at:"2015-07-08T02:54:33Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float speed;uniform float angle;uniform float power;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 q=p;float t=pow(progress,power)*speed;p=p-0.5;for(int i=0;i<7;i++){p=vec2(sin(t)*p.x+cos(t)*p.y,sin(t)*p.y-cos(t)*p.x);t+=angle;p=abs(mod(p,2.0)-1.0);}abs(mod(p,1.0));gl_FragColor=mix(mix(texture2D(from,q),texture2D(to,q),progress),mix(texture2D(from,p),texture2D(to,p),progress),1.0-2.0*abs(progress-0.5));}"},{id:"408045772d255df97520",name:"SimpleFlip",owner:"nwoeanhinnogaehr",uniforms:{},html_url:"https://gist.github.com/408045772d255df97520",created_at:"2014-05-23T18:42:58Z",updated_at:"2015-07-08T02:59:51Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 q=p;p.x=(p.x-0.5)/abs(progress-0.5)*0.5+0.5;vec4 a=texture2D(from,p);vec4 b=texture2D(to,p);gl_FragColor=vec4(mix(a,b,step(0.5,progress)).rgb*step(abs(q.x-0.5),abs(progress-0.5)),1.0);}"},{id:"a070cbd69e2535e757f1",name:"DoomScreenTransition",owner:"zeh",uniforms:{barWidth:10,noise:.2,amplitude:2,frequency:1},html_url:"https://gist.github.com/a070cbd69e2535e757f1",created_at:"2014-05-23T18:00:18Z",updated_at:"2015-07-08T02:52:47Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform int barWidth;uniform float amplitude;uniform float noise;uniform float frequency;float rand(int num){return fract(mod(float(num)*67123.313,12.0)*sin(float(num)*10.3)*cos(float(num)));}float wave(int num){float fn=float(num)*frequency*0.1*float(barWidth);return cos(fn*0.5)*cos(fn*0.13)*sin((fn+10.0)*0.3)/2.0+0.5;}float pos(int num){return noise==0.0?wave(num):mix(wave(num),rand(num),noise);}void main(){int bar=int(gl_FragCoord.x)/barWidth;float scale=1.0+pos(bar)*amplitude;float phase=progress*scale;float posY=gl_FragCoord.y/resolution.y;vec2 p;vec4 c;if(phase+posY<1.0){p=vec2(gl_FragCoord.x,gl_FragCoord.y+mix(0.0,resolution.y,phase))/resolution.xy;c=texture2D(from,p);}else{p=gl_FragCoord.xy/resolution.xy;c=texture2D(to,p);}gl_FragColor=c;}"},{id:"a830822b23e846e25d2d",name:"DreamyZoom",owner:"zeh",uniforms:{rotation:6,scale:1.2},html_url:"https://gist.github.com/a830822b23e846e25d2d",created_at:"2014-05-23T15:27:25Z",updated_at:"2015-07-08T02:51:41Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define DEG2RAD 0.03926990816987241548078304229099 // 1/180*PI\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float rotation;uniform float scale;void main(){float phase=progress<0.5?progress*2.0:(progress-0.5)*2.0;float angleOffset=progress<0.5?mix(0.0,rotation*DEG2RAD,phase):mix(-rotation*DEG2RAD,0.0,phase);float newScale=progress<0.5?mix(1.0,scale,phase):mix(scale,1.0,phase);vec2 center=vec2(0,0);float maxRes=max(resolution.x,resolution.y);float resX=resolution.x/maxRes*0.5;float resY=resolution.y/maxRes*0.5;vec2 p=(gl_FragCoord.xy/maxRes-vec2(resX,resY))/newScale;float angle=atan(p.y,p.x)+angleOffset;float dist=distance(center,p);p.x=cos(angle)*dist+resX;p.y=sin(angle)*dist+resY;vec4 c=progress<0.5?texture2D(from,p):texture2D(to,p);gl_FragColor=c+(progress<0.5?mix(0.0,1.0,phase):mix(1.0,0.0,phase));}"},{id:"b6720916aa3f035949bc",name:"squareswipe",owner:"gre",uniforms:{squares:[10,10],direction:[1,-.5],smoothness:1.6},html_url:"https://gist.github.com/b6720916aa3f035949bc",created_at:"2014-05-23T12:09:38Z",updated_at:"2015-07-08T02:50:09Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform ivec2 squares;uniform vec2 direction;uniform float smoothness;const vec2 center=vec2(0.5,0.5);void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 v=normalize(direction);if(v!=vec2(0.0)) v/=abs(v.x)+abs(v.y);float d=v.x*center.x+v.y*center.y;float offset=smoothness;float pr=smoothstep(-offset,0.0,v.x*p.x+v.y*p.y-(d-0.5+progress*(1.+offset)));vec2 squarep=fract(p*vec2(squares));vec2 squaremin=vec2(pr/2.0);vec2 squaremax=vec2(1.0-pr/2.0);float a=all(lessThan(squaremin,squarep))&&all(lessThan(squarep,squaremax))?1.0:0.0;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),a);}"},{id:"169781bb76f310e2bfde",name:"TilesWaveBottomLeftToTopRight",owner:"numb3r23",uniforms:{tileSize:[64,64],checkerDistance:0,flipX:!1,flipY:!1,preTileSingleColor:!1,postTileSingleColor:!1},html_url:"https://gist.github.com/169781bb76f310e2bfde",created_at:"2014-05-21T22:50:48Z",updated_at:"2015-07-08T02:54:32Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform vec2 tileSize;uniform float checkerDistance;uniform bool flipX;uniform bool flipY;uniform bool preTileSingleColor;uniform bool postTileSingleColor;vec2 tile2Global(vec2 tex,vec2 tileNum,bool tileSingleColor){vec2 perTile=tileSize/resolution.xy;return tileNum*perTile+(tileSingleColor?vec2(0):tex*perTile);}void main(void){vec2 uv=gl_FragCoord.xy/resolution.xy;vec4 fragColor=vec4(1,1,0,1);vec2 posInTile=mod(vec2(gl_FragCoord),tileSize);vec2 tileNum=floor(vec2(gl_FragCoord)/tileSize);int num=int(tileNum.x);vec2 totalTiles=ceil(resolution.xy/tileSize);float countTiles=totalTiles.x*totalTiles.y;vec2 perTile=ceil(tileSize/resolution.xy);float offset=0.0;offset=(tileNum.y+tileNum.x*perTile.y)/(sqrt(countTiles)*2.0);float timeOffset=(progress-offset)*countTiles;timeOffset=clamp(timeOffset,0.0,0.5);float sinTime=1.0-abs(cos(fract(timeOffset)*3.1415926));fragColor.rg=uv;fragColor.b=sinTime;vec2 texC=posInTile/tileSize;if(sinTime<=0.5){if(flipX){if((texC.x<sinTime)||(texC.x>1.0-sinTime)){discard;}if(texC.x<0.5){texC.x=(texC.x-sinTime)*0.5/(0.5-sinTime);}else{texC.x=(texC.x-0.5)*0.5/(0.5-sinTime)+0.5;}}if(flipY){if((texC.y<sinTime)||(texC.y>1.0-sinTime)){discard;}if(texC.y<0.5){texC.y=(texC.y-sinTime)*0.5/(0.5-sinTime);}else{texC.y=(texC.y-0.5)*0.5/(0.5-sinTime)+0.5;}}fragColor=texture2D(from,tile2Global(texC,tileNum,preTileSingleColor));}else{if(flipX){if((texC.x>sinTime)||(texC.x<1.0-sinTime)){discard;}if(texC.x<0.5){texC.x=(texC.x-sinTime)*0.5/(0.5-sinTime);}else{texC.x=(texC.x-0.5)*0.5/(0.5-sinTime)+0.5;}texC.x=1.0-texC.x;}if(flipY){if((texC.y>sinTime)||(texC.y<1.0-sinTime)){discard;}if(texC.y<0.5){texC.y=(texC.y-sinTime)*0.5/(0.5-sinTime);}else{texC.y=(texC.y-0.5)*0.5/(0.5-sinTime)+0.5;}texC.y=1.0-texC.y;}fragColor.rgb=texture2D(to,tile2Global(texC,tileNum,postTileSingleColor)).rgb;}gl_FragColor=fragColor;}"},{id:"5ebd3442a208861c7a8a",name:"TilesScanline",owner:"numb3r23",uniforms:{},html_url:"https://gist.github.com/5ebd3442a208861c7a8a",created_at:"2014-05-21T22:49:22Z",updated_at:"2015-07-08T02:51:40Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;const vec2 tileSize=vec2(64,64);const float checkerDistance=0.015;const bool flipX=true;const bool flipY=false;const bool preTileSingleColor=false;const bool postTileSingleColor=false;vec2 tile2Global(vec2 tex,vec2 tileNum,bool tileSingleColor){vec2 perTile=tileSize/resolution.xy;return tileNum*perTile+(tileSingleColor?vec2(0):tex*perTile);}void main(void){vec2 uv=gl_FragCoord.xy/resolution.xy;vec4 fragColor=vec4(1,1,0,1);vec2 posInTile=mod(vec2(gl_FragCoord),tileSize);vec2 tileNum=floor(vec2(gl_FragCoord)/tileSize);int num=int(tileNum.x);vec2 totalTiles=ceil(resolution.xy/tileSize);float countTiles=totalTiles.x*totalTiles.y;vec2 perTile=ceil(tileSize/resolution.xy);float offset=0.0;offset=(tileNum.x+tileNum.y*totalTiles.x)/countTiles;float timeOffset=(progress-offset)*countTiles;timeOffset=clamp(timeOffset,0.0,0.5);float sinTime=1.0-abs(cos(fract(timeOffset)*3.1415926));fragColor.rg=uv;fragColor.b=sinTime;vec2 texC=posInTile/tileSize;if(sinTime<=0.5){if(flipX){if((texC.x<sinTime)||(texC.x>1.0-sinTime)){discard;}if(texC.x<0.5){texC.x=(texC.x-sinTime)*0.5/(0.5-sinTime);}else{texC.x=(texC.x-0.5)*0.5/(0.5-sinTime)+0.5;}}if(flipY){if((texC.y<sinTime)||(texC.y>1.0-sinTime)){discard;}if(texC.y<0.5){texC.y=(texC.y-sinTime)*0.5/(0.5-sinTime);}else{texC.y=(texC.y-0.5)*0.5/(0.5-sinTime)+0.5;}}fragColor=texture2D(from,tile2Global(texC,tileNum,preTileSingleColor));}else{if(flipX){if((texC.x>sinTime)||(texC.x<1.0-sinTime)){discard;}if(texC.x<0.5){texC.x=(texC.x-sinTime)*0.5/(0.5-sinTime);}else{texC.x=(texC.x-0.5)*0.5/(0.5-sinTime)+0.5;}texC.x=1.0-texC.x;}if(flipY){if((texC.y>sinTime)||(texC.y<1.0-sinTime)){discard;}if(texC.y<0.5){texC.y=(texC.y-sinTime)*0.5/(0.5-sinTime);}else{texC.y=(texC.y-0.5)*0.5/(0.5-sinTime)+0.5;}texC.y=1.0-texC.y;}fragColor.rgb=texture2D(to,tile2Global(texC,tileNum,postTileSingleColor)).rgb;}gl_FragColor=fragColor;}"},{id:"9e86d2712e123542758b",name:"Dreamy",owner:"mikolalysenko",uniforms:{},html_url:"https://gist.github.com/9e86d2712e123542758b",created_at:"2014-05-21T14:55:01Z",updated_at:"2015-07-08T02:54:01Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;vec2 offset(float progress,float x,float theta){float phase=progress*progress+progress+theta;float shifty=0.03*progress*cos(10.0*(progress+x));return vec2(0,shifty);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(texture2D(from,p+offset(progress,p.x,0.0)),texture2D(to,p+offset(1.0-progress,p.x,3.14)),progress);}"},{id:"21d2fdd24c706952dc8c",name:"AdvancedMosaic",owner:"corporateshark",uniforms:{},html_url:"https://gist.github.com/21d2fdd24c706952dc8c",created_at:"2014-05-21T14:45:52Z",updated_at:"2015-07-08T02:59:04Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(void){vec2 p=gl_FragCoord.xy/resolution.xy;float T=progress;float S0=1.0;float S1=50.0;float S2=1.0;float Half=0.5;float PixelSize=(T<Half)?mix(S0,S1,T/Half):mix(S1,S2,(T-Half)/Half);vec2 D=PixelSize/resolution.xy;vec2 UV=(p+vec2(-0.5))/D;vec2 Coord=clamp(D*(ceil(UV+vec2(-0.5)))+vec2(0.5),vec2(0.0),vec2(1.0));vec4 C0=texture2D(from,Coord);vec4 C1=texture2D(to,Coord);gl_FragColor=mix(C0,C1,T);}"},{id:"cacfedb8cca0f5ce3f7c",name:"Swirl",owner:"corporateshark",uniforms:{},html_url:"https://gist.github.com/cacfedb8cca0f5ce3f7c",created_at:"2014-05-21T14:43:04Z",updated_at:"2015-07-08T02:56:22Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(void){float Radius=1.0;float T=progress;vec2 UV=gl_FragCoord.xy/resolution.xy;UV-=vec2(0.5,0.5);float Dist=length(UV);if(Dist<Radius){float Percent=(Radius-Dist)/Radius;float A=(T<=0.5)?mix(0.0,1.0,T/0.5):mix(1.0,0.0,(T-0.5)/0.5);float Theta=Percent*Percent*A*8.0*3.14159;float S=sin(Theta);float C=cos(Theta);UV=vec2(dot(UV,vec2(C,-S)),dot(UV,vec2(S,C)));}UV+=vec2(0.5,0.5);vec4 C0=texture2D(from,UV);vec4 C1=texture2D(to,UV);gl_FragColor=mix(C0,C1,T);}"},{id:"b9f8e5675c647e615419",name:"DefocusBlur",owner:"corporateshark",uniforms:{},html_url:"https://gist.github.com/b9f8e5675c647e615419",created_at:"2014-05-21T10:12:14Z",updated_at:"2015-07-08T02:58:32Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform float progress;uniform vec2 resolution;uniform sampler2D from;uniform sampler2D to;void main(void){vec2 p=gl_FragCoord.xy/resolution.xy;float T=progress;float S0=1.0;float S1=50.0;float S2=1.0;float Half=0.5;float PixelSize=(T<Half)?mix(S0,S1,T/Half):mix(S1,S2,(T-Half)/Half);vec2 D=PixelSize/resolution.xy;vec2 UV=(gl_FragCoord.xy/resolution.xy);const int NumTaps=12;vec2 Disk[NumTaps];Disk[0]=vec2(-.326,-.406);Disk[1]=vec2(-.840,-.074);Disk[2]=vec2(-.696,.457);Disk[3]=vec2(-.203,.621);Disk[4]=vec2(.962,-.195);Disk[5]=vec2(.473,-.480);Disk[6]=vec2(.519,.767);Disk[7]=vec2(.185,-.893);Disk[8]=vec2(.507,.064);Disk[9]=vec2(.896,.412);Disk[10]=vec2(-.322,-.933);Disk[11]=vec2(-.792,-.598);vec4 C0=texture2D(from,UV);vec4 C1=texture2D(to,UV);for(int i=0;i!=NumTaps;i++){C0+=texture2D(from,Disk[i]*D+UV);C1+=texture2D(to,Disk[i]*D+UV);}C0/=float(NumTaps+1);C1/=float(NumTaps+1);gl_FragColor=mix(C0,C1,T);}"},{id:"2a5fa2f77c883dd661f9",name:"colourDistance",owner:"P-Seebauer",uniforms:{interpolationPower:5},html_url:"https://gist.github.com/2a5fa2f77c883dd661f9",created_at:"2014-05-21T07:10:21Z",updated_at:"2015-07-08T02:51:18Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float interpolationPower;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 fTex=texture2D(from,p);vec4 tTex=texture2D(to,p);gl_FragColor=mix(distance(fTex,tTex)>progress?fTex:tTex,tTex,pow(progress,interpolationPower));}"},{id:"b93818de23d4511fde10",name:"Dissolve",owner:"nwoeanhinnogaehr",uniforms:{blocksize:1},html_url:"https://gist.github.com/b93818de23d4511fde10",created_at:"2014-05-20T23:40:57Z",updated_at:"2015-07-08T02:59:23Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float blocksize;float rand(vec2 co){return fract(sin(dot(co,vec2(12.9898,78.233)))*43758.5453);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),step(rand(floor(gl_FragCoord.xy/blocksize)),progress));}"},{id:"b185145363d65751009b",name:"HSVfade",owner:"nwoeanhinnogaehr",uniforms:{},html_url:"https://gist.github.com/b185145363d65751009b",created_at:"2014-05-20T23:21:27Z",updated_at:"2015-07-08T02:58:55Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;vec3 hsv2rgb(vec3 c){const vec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);vec3 p=abs(fract(c.xxx+K.xyz)*6.0-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),c.y);}vec3 rgb2hsv(vec3 c){const vec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);vec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));vec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));float d=q.x-min(q.w,q.y);return vec3(abs(q.z+(q.w-q.y)/(6.0*d+0.001)),d/(q.x+0.001),q.x);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec3 a=rgb2hsv(texture2D(from,p).rgb);vec3 b=rgb2hsv(texture2D(to,p).rgb);vec3 m=mix(a,b,progress);gl_FragColor=vec4(hsv2rgb(m),1.0);}"},{id:"f6fc39f4cfcbb97f96a6",name:"Fold",owner:"nwoeanhinnogaehr",uniforms:{},html_url:"https://gist.github.com/f6fc39f4cfcbb97f96a6",created_at:"2014-05-20T23:14:23Z",updated_at:"2015-07-08T02:54:57Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 a=texture2D(from,(p-vec2(progress,0.0))/vec2(1.0-progress,1.0));vec4 b=texture2D(to,p/vec2(progress,1.0));gl_FragColor=mix(a,b,step(p.x,progress));}"},{id:"80c2d40cac3f98453176",name:"linearblur",owner:"gre",uniforms:{intensity:.1},html_url:"https://gist.github.com/80c2d40cac3f98453176",created_at:"2014-05-20T22:02:35Z",updated_at:"2015-07-08T02:58:37Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float intensity;const int PASSES=8;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 c1=vec4(0.0),c2=vec4(0.0);float disp=intensity*(0.5-distance(0.5,progress));for(int xi=0;xi<PASSES;++xi){float x=float(xi)/float(PASSES)-0.5;for(int yi=0;yi<PASSES;++yi){float y=float(yi)/float(PASSES)-0.5;vec2 v=vec2(x,y);float d=disp;c1+=texture2D(from,p+d*v);c2+=texture2D(to,p+d*v);}}c1/=float(PASSES*PASSES);c2/=float(PASSES*PASSES);gl_FragColor=mix(c1,c2,progress);}"},{id:"c528607361d90a072e98",name:"pixelize",owner:"benraziel",uniforms:{},html_url:"https://gist.github.com/c528607361d90a072e98",created_at:"2014-05-20T19:32:42Z",updated_at:"2015-07-08T02:58:15Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){float revProgress=(1.0-progress);float distFromEdges=min(progress,revProgress);float squareSize=(50.0*distFromEdges)+1.0;vec2 p=(floor((gl_FragCoord.xy+squareSize*0.5)/squareSize)*squareSize)/resolution.xy;vec4 fromColor=texture2D(from,p);vec4 toColor=texture2D(to,p);gl_FragColor=mix(fromColor,toColor,progress);}"},{id:"abd06f4d23ab2ff4ed7a",name:"random_squares",owner:"benraziel",uniforms:{},html_url:"https://gist.github.com/abd06f4d23ab2ff4ed7a",created_at:"2014-05-20T19:07:25Z",updated_at:"2015-07-08T02:58:29Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){float revProgress=(1.0-progress);float distFromEdges=min(progress,revProgress);vec2 p=gl_FragCoord.xy/resolution.xy;vec4 fromColor=texture2D(from,p);vec4 toColor=texture2D(to,p);float squareSize=20.0;float flickerSpeed=60.0;vec2 seed=floor(gl_FragCoord.xy/squareSize)*floor(distFromEdges*flickerSpeed);gl_FragColor=mix(fromColor,toColor,progress)+rand(seed)*distFromEdges*0.5;}"},{id:"791d0f058ae6a83e0c15",name:"PolkaDotsCurtain",owner:"bobylito",uniforms:{center:[1,1],dots:20},html_url:"https://gist.github.com/791d0f058ae6a83e0c15",created_at:"2014-05-20T16:55:46Z",updated_at:"2015-07-08T02:53:24Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;const float SQRT_2=1.414213562373;uniform float dots;uniform vec2 center;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float x=progress/2.0;bool nextImage=distance(fract(p*dots),vec2(0.5,0.5))<(2.0*x/distance(p,center));if(nextImage) gl_FragColor=texture2D(to,p);else gl_FragColor=texture2D(from,p);}"},{id:"166e496a19a4fdbf1aae",name:"PageCurl",owner:"corporateshark",uniforms:{},html_url:"https://gist.github.com/166e496a19a4fdbf1aae",created_at:"2014-05-20T12:37:15Z",updated_at:"2015-07-08T02:58:48Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;const float MIN_AMOUNT=-0.16;const float MAX_AMOUNT=1.3;float amount=progress*(MAX_AMOUNT-MIN_AMOUNT)+MIN_AMOUNT;const float PI=3.141592653589793;const float scale=512.0;const float sharpness=3.0;float cylinderCenter=amount;float cylinderAngle=2.0*PI*amount;const float cylinderRadius=1.0/PI/2.0;vec3 hitPoint(float hitAngle,float yc,vec3 point,mat3 rrotation){float hitPoint=hitAngle/(2.0*PI);point.y=hitPoint;return rrotation*point;}vec4 antiAlias(vec4 color1,vec4 color2,float distanc){distanc*=scale;if(distanc<0.0) return color2;if(distanc>2.0) return color1;float dd=pow(1.0-distanc/2.0,sharpness);return ((color2-color1)*dd)+color1;}float distanceToEdge(vec3 point){float dx=abs(point.x>0.5?1.0-point.x:point.x);float dy=abs(point.y>0.5?1.0-point.y:point.y);if(point.x<0.0) dx=-point.x;if(point.x>1.0) dx=point.x-1.0;if(point.y<0.0) dy=-point.y;if(point.y>1.0) dy=point.y-1.0;if((point.x<0.0||point.x>1.0)&&(point.y<0.0||point.y>1.0)) return sqrt(dx*dx+dy*dy);return min(dx,dy);}vec4 seeThrough(float yc,vec2 p,mat3 rotation,mat3 rrotation){float hitAngle=PI-(acos(yc/cylinderRadius)-cylinderAngle);vec3 point=hitPoint(hitAngle,yc,rotation*vec3(p,1.0),rrotation);if(yc<=0.0&&(point.x<0.0||point.y<0.0||point.x>1.0||point.y>1.0)){vec2 texCoord=gl_FragCoord.xy/resolution.xy;return texture2D(to,texCoord);}if(yc>0.0) return texture2D(from,p);vec4 color=texture2D(from,point.xy);vec4 tcolor=vec4(0.0);return antiAlias(color,tcolor,distanceToEdge(point));}vec4 seeThroughWithShadow(float yc,vec2 p,vec3 point,mat3 rotation,mat3 rrotation){float shadow=distanceToEdge(point)*30.0;shadow=(1.0-shadow)/3.0;if(shadow<0.0) shadow=0.0;else shadow*=amount;vec4 shadowColor=seeThrough(yc,p,rotation,rrotation);shadowColor.r-=shadow;shadowColor.g-=shadow;shadowColor.b-=shadow;return shadowColor;}vec4 backside(float yc,vec3 point){vec4 color=texture2D(from,point.xy);float gray=(color.r+color.b+color.g)/15.0;gray+=(8.0/10.0)*(pow(1.0-abs(yc/cylinderRadius),2.0/10.0)/2.0+(5.0/10.0));color.rgb=vec3(gray);return color;}vec4 behindSurface(float yc,vec3 point,mat3 rrotation){float shado=(1.0-((-cylinderRadius-yc)/amount*7.0))/6.0;shado*=1.0-abs(point.x-0.5);yc=(-cylinderRadius-cylinderRadius-yc);float hitAngle=(acos(yc/cylinderRadius)+cylinderAngle)-PI;point=hitPoint(hitAngle,yc,point,rrotation);if(yc<0.0&&point.x>=0.0&&point.y>=0.0&&point.x<=1.0&&point.y<=1.0&&(hitAngle<PI||amount>0.5)){shado=1.0-(sqrt(pow(point.x-0.5,2.0)+pow(point.y-0.5,2.0))/(71.0/100.0));shado*=pow(-yc/cylinderRadius,3.0);shado*=0.5;}else{shado=0.0;}vec2 texCoord=gl_FragCoord.xy/resolution.xy;return vec4(texture2D(to,texCoord).rgb-shado,1.0);}void main(){vec2 texCoord=gl_FragCoord.xy/resolution.xy;const float angle=30.0*PI/180.0;float c=cos(-angle);float s=sin(-angle);mat3 rotation=mat3(c,s,0,-s,c,0,0.12,0.258,1);c=cos(angle);s=sin(angle);mat3 rrotation=mat3(c,s,0,-s,c,0,0.15,-0.5,1);vec3 point=rotation*vec3(texCoord,1.0);float yc=point.y-cylinderCenter;if(yc<-cylinderRadius){gl_FragColor=behindSurface(yc,point,rrotation);return;}if(yc>cylinderRadius){gl_FragColor=texture2D(from,texCoord);return;}float hitAngle=(acos(yc/cylinderRadius)+cylinderAngle)-PI;float hitAngleMod=mod(hitAngle,2.0*PI);if((hitAngleMod>PI&&amount<0.5)||(hitAngleMod>PI/2.0&&amount<0.0)){gl_FragColor=seeThrough(yc,texCoord,rotation,rrotation);return;}point=hitPoint(hitAngle,yc,point,rrotation);if(point.x<0.0||point.y<0.0||point.x>1.0||point.y>1.0){gl_FragColor=seeThroughWithShadow(yc,texCoord,point,rotation,rrotation);return;}vec4 color=backside(yc,point);vec4 otherColor;if(yc<0.0){float shado=1.0-(sqrt(pow(point.x-0.5,2.0)+pow(point.y-0.5,2.0))/0.71);shado*=pow(-yc/cylinderRadius,3.0);shado*=0.5;otherColor=vec4(0.0,0.0,0.0,shado);}else{otherColor=texture2D(from,texCoord);}color=antiAlias(color,otherColor,cylinderRadius-abs(yc));vec4 cl=seeThroughWithShadow(yc,texCoord,point,rotation,rrotation);float dist=distanceToEdge(point);gl_FragColor=antiAlias(color,cl,dist);}"
},{id:"06450f79cab706705bf9",name:"Polka_dots",owner:"bobylito",uniforms:{dots:5},html_url:"https://gist.github.com/06450f79cab706705bf9",created_at:"2014-05-20T12:09:38Z",updated_at:"2015-07-08T02:50:01Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float dots;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float x=progress;bool nextImage=distance(fract(p*dots),vec2(0.5,0.5))<x;if(nextImage) gl_FragColor=texture2D(to,p);else gl_FragColor=texture2D(from,p);}"},{id:"3da654388c3f3cd031c0",name:"burn",owner:"gre",uniforms:{color:[.9,.4,.2]},html_url:"https://gist.github.com/3da654388c3f3cd031c0",created_at:"2014-05-20T09:06:02Z",updated_at:"2015-07-08T02:56:43Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform vec3 color;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(texture2D(from,p)+vec4(progress*color,1.0),texture2D(to,p)+vec4((1.0-progress)*color,1.0),progress);}"},{id:"e5f807b5dffb09fc7527",name:"FinalGaussianNoise",owner:"mandubian",uniforms:{},html_url:"https://gist.github.com/e5f807b5dffb09fc7527",created_at:"2014-05-19T21:34:07Z",updated_at:"2015-07-08T02:52:13Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;float Rand(vec2 v){return fract(sin(dot(v.xy,vec2(12.9898,78.233)))*43758.5453);}float Gaussian(float p,float center,float c){return 0.75*exp(-pow((p-center)/c,2.));}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float c=cos(Gaussian(progress*(1.+Gaussian(progress*Rand(p),0.5,0.5)),0.5,0.25));vec2 d=p*c;gl_FragColor=mix(texture2D(from,d),texture2D(to,d),progress);}"},{id:"130bb7b7affedbda9df5",name:"Mosaic",owner:"Xaychru",uniforms:{endx:0,endy:-1},html_url:"https://gist.github.com/130bb7b7affedbda9df5",created_at:"2014-05-19T16:51:58Z",updated_at:"2015-07-08T02:55:37Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define PI 3.14159265358979323\n\n#define POW2(X) X*X\n\n#define POW3(X) X*X*X\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform int endx;uniform int endy;float Rand(vec2 v){return fract(sin(dot(v.xy,vec2(12.9898,78.233)))*43758.5453);}vec2 Rotate(vec2 v,float a){mat2 rm=mat2(cos(a),-sin(a),sin(a),cos(a));return rm*v;}float CosInterpolation(float x){return -cos(x*PI)/2.+.5;}void main(){vec2 p=gl_FragCoord.xy/resolution.xy-.5;vec2 rp=p;float rpr=(progress*2.-1.);float z=-(rpr*rpr*2.)+3.;float az=abs(z);rp*=az;rp+=mix(vec2(.5,.5),vec2(float(endx)+.5,float(endy)+.5),POW2(CosInterpolation(progress)));vec2 mrp=mod(rp,1.);vec2 crp=rp;bool onEnd=int(floor(crp.x))==endx&&int(floor(crp.y))==endy;if(!onEnd){float ang=float(int(Rand(floor(crp))*4.))*.5*PI;mrp=vec2(.5)+Rotate(mrp-vec2(.5),ang);}if(onEnd||Rand(floor(crp))>.5){gl_FragColor=texture2D(to,mrp);}else{gl_FragColor=texture2D(from,mrp);}}"},{id:"ce1d48f0ce00bb379750",name:"Radial",owner:"Xaychru",uniforms:{},html_url:"https://gist.github.com/ce1d48f0ce00bb379750",created_at:"2014-05-19T15:18:28Z",updated_at:"2015-07-08T02:55:51Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define PI 3.141592653589\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 rp=p*2.-1.;float a=atan(rp.y,rp.x);float pa=progress*PI*2.5-PI*1.25;vec4 fromc=texture2D(from,p);vec4 toc=texture2D(to,p);if(a>pa){gl_FragColor=mix(toc,fromc,smoothstep(0.,1.,(a-pa)));}else{gl_FragColor=toc;}}"},{id:"c3bc914de09227713787",name:"ButterflyWaveScrawler",owner:"mandubian",uniforms:{amplitude:1,waves:30,colorSeparation:.3},html_url:"https://gist.github.com/c3bc914de09227713787",created_at:"2014-05-19T11:48:15Z",updated_at:"2015-07-08T02:53:28Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float amplitude;uniform float waves;uniform float colorSeparation;float PI=3.14159265358979323846264;float compute(vec2 p,float progress,vec2 center){vec2 o=p*sin(progress*amplitude)-center;vec2 h=vec2(1.,0.);float theta=acos(dot(o,h))*waves;return (exp(cos(theta))-2.*cos(4.*theta)+pow(sin((2.*theta-PI)/24.),5.))/10.;}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float inv=1.-progress;vec2 dir=p-vec2(.5);float dist=length(dir);float disp=compute(p,progress,vec2(0.5,0.5));vec4 texTo=texture2D(to,p+inv*disp);vec4 texFrom=vec4(texture2D(from,p+progress*disp*(1.0-colorSeparation)).r,texture2D(from,p+progress*disp).g,texture2D(from,p+progress*disp*(1.0+colorSeparation)).b,1.0);gl_FragColor=texTo*progress+texFrom*inv;}"},{id:"4268c81d39bd4ca00ae2",name:"CrazyParametricFun",owner:"mandubian",uniforms:{a:4,b:1,amplitude:120,smoothness:.1},html_url:"https://gist.github.com/4268c81d39bd4ca00ae2",created_at:"2014-05-19T08:04:52Z",updated_at:"2015-07-08T02:50:51Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float a;uniform float b;uniform float amplitude;uniform float smoothness;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 dir=p-vec2(.5);float dist=length(dir);float x=(a-b)*cos(progress)+b*cos(progress*((a/b)-1.));float y=(a-b)*sin(progress)-b*sin(progress*((a/b)-1.));vec2 offset=dir*vec2(sin(progress*dist*amplitude*x),sin(progress*dist*amplitude*y))/smoothness;gl_FragColor=mix(texture2D(from,p+offset),texture2D(to,p),smoothstep(0.2,1.0,progress));}"},{id:"2bcfb59096fcaed82355",name:"powerdisformation",owner:"gre",uniforms:{power:3,powerDest:!0},html_url:"https://gist.github.com/2bcfb59096fcaed82355",created_at:"2014-05-17T10:58:29Z",updated_at:"2015-07-08T02:59:00Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from,to;uniform float progress;uniform vec2 resolution;uniform float power;uniform bool powerDest;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 p2=mix(p,vec2(pow(p.x,power),pow(p.y,power)),(powerDest?0.5:1.0)-distance(progress,powerDest?0.5:1.0));gl_FragColor=mix(texture2D(from,p2),texture2D(to,powerDest?p2:p),progress);}"},{id:"2a3f2e907e1c0a152e60",name:"swap",owner:"gre",uniforms:{reflection:.4,perspective:.2,depth:3},html_url:"https://gist.github.com/2a3f2e907e1c0a152e60",created_at:"2014-05-16T13:59:07Z",updated_at:"2015-07-08T02:51:24Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float reflection;uniform float perspective;uniform float depth;const vec4 black=vec4(0.0,0.0,0.0,1.0);const vec2 boundMin=vec2(0.0,0.0);const vec2 boundMax=vec2(1.0,1.0);bool inBounds(vec2 p){return all(lessThan(boundMin,p))&&all(lessThan(p,boundMax));}vec2 project(vec2 p){return p*vec2(1.0,-1.2)+vec2(0.0,-0.02);}vec4 bgColor(vec2 p,vec2 pfr,vec2 pto){vec4 c=black;pfr=project(pfr);if(inBounds(pfr)){c+=mix(black,texture2D(from,pfr),reflection*mix(1.0,0.0,pfr.y));}pto=project(pto);if(inBounds(pto)){c+=mix(black,texture2D(to,pto),reflection*mix(1.0,0.0,pto.y));}return c;}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 pfr,pto=vec2(-1.);float size=mix(1.0,depth,progress);float persp=perspective*progress;pfr=(p+vec2(-0.0,-0.5))*vec2(size/(1.0-perspective*progress),size/(1.0-size*persp*p.x))+vec2(0.0,0.5);size=mix(1.0,depth,1.-progress);persp=perspective*(1.-progress);pto=(p+vec2(-1.0,-0.5))*vec2(size/(1.0-perspective*(1.0-progress)),size/(1.0-size*persp*(0.5-p.x)))+vec2(1.0,0.5);bool fromOver=progress<0.5;if(fromOver){if(inBounds(pfr)){gl_FragColor=texture2D(from,pfr);}else if(inBounds(pto)){gl_FragColor=texture2D(to,pto);}else{gl_FragColor=bgColor(p,pfr,pto);}}else{if(inBounds(pto)){gl_FragColor=texture2D(to,pto);}else if(inBounds(pfr)){gl_FragColor=texture2D(from,pfr);}else{gl_FragColor=bgColor(p,pfr,pto);}}}"},{id:"94ffa2725b65aa8b9979",name:"ripple",owner:"gre",uniforms:{amplitude:100,speed:50},html_url:"https://gist.github.com/94ffa2725b65aa8b9979",created_at:"2014-05-16T13:58:42Z",updated_at:"2015-07-08T02:57:37Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float amplitude;uniform float speed;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 dir=p-vec2(.5);float dist=length(dir);vec2 offset=dir*(sin(progress*dist*amplitude-progress*speed)+.5)/30.;gl_FragColor=mix(texture2D(from,p+offset),texture2D(to,p),smoothstep(0.2,1.0,progress));}"},{id:"99bced7d9b5311fd166e",name:"flash",owner:"gre",uniforms:{flashPhase:.3,flashIntensity:3,flashZoomEffect:.5},html_url:"https://gist.github.com/99bced7d9b5311fd166e",created_at:"2014-05-16T13:58:17Z",updated_at:"2015-07-08T02:52:11Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float flashPhase;uniform float flashIntensity;uniform float flashZoomEffect;const vec3 flashColor=vec3(1.0,0.8,0.3);const float flashVelocity=3.0;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 fc=texture2D(from,p);vec4 tc=texture2D(to,p);float intensity=mix(1.0,2.0*distance(p,vec2(0.5,0.5)),flashZoomEffect)*flashIntensity*pow(smoothstep(flashPhase,0.0,distance(0.5,progress)),flashVelocity);vec4 c=mix(texture2D(from,p),texture2D(to,p),smoothstep(0.5*(1.0-flashPhase),0.5*(1.0+flashPhase),progress));c+=intensity*vec4(flashColor,1.0);gl_FragColor=c;}"},{id:"81c6f2e6fce88f9075d2",name:"flyeye",owner:"gre",uniforms:{size:.04,zoom:30,colorSeparation:.3},html_url:"https://gist.github.com/81c6f2e6fce88f9075d2",created_at:"2014-05-16T13:56:53Z",updated_at:"2015-07-08T02:58:40Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float size;uniform float zoom;uniform float colorSeparation;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float inv=1.-progress;vec2 disp=size*vec2(cos(zoom*p.x),sin(zoom*p.y));vec4 texTo=texture2D(to,p+inv*disp);vec4 texFrom=vec4(texture2D(from,p+progress*disp*(1.0-colorSeparation)).r,texture2D(from,p+progress*disp).g,texture2D(from,p+progress*disp*(1.0+colorSeparation)).b,1.0);gl_FragColor=texTo*progress+texFrom*inv;}"},{id:"979934722820b5e715fa",name:"doorway",owner:"gre",uniforms:{reflection:.4,perspective:.4,depth:3},html_url:"https://gist.github.com/979934722820b5e715fa",created_at:"2014-05-16T13:54:38Z",updated_at:"2015-07-08T02:50:19Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float reflection;uniform float perspective;uniform float depth;const vec4 black=vec4(0.0,0.0,0.0,1.0);const vec2 boundMin=vec2(0.0,0.0);const vec2 boundMax=vec2(1.0,1.0);bool inBounds(vec2 p){return all(lessThan(boundMin,p))&&all(lessThan(p,boundMax));}vec2 project(vec2 p){return p*vec2(1.0,-1.2)+vec2(0.0,-0.02);}vec4 bgColor(vec2 p,vec2 pto){vec4 c=black;pto=project(pto);if(inBounds(pto)){c+=mix(black,texture2D(to,pto),reflection*mix(1.0,0.0,pto.y));}return c;}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 pfr=vec2(-1.),pto=vec2(-1.);float middleSlit=2.0*abs(p.x-0.5)-progress;if(middleSlit>0.0){pfr=p+(p.x>0.5?-1.0:1.0)*vec2(0.5*progress,0.0);float d=1.0/(1.0+perspective*progress*(1.0-middleSlit));pfr.y-=d/2.;pfr.y*=d;pfr.y+=d/2.;}float size=mix(1.0,depth,1.-progress);pto=(p+vec2(-0.5,-0.5))*vec2(size,size)+vec2(0.5,0.5);if(inBounds(pfr)){gl_FragColor=texture2D(from,pfr);}else if(inBounds(pto)){gl_FragColor=texture2D(to,pto);}else{gl_FragColor=bgColor(p,pto);}}"},{id:"731fcad4f8956866f34a",name:"randomsquares",owner:"gre",uniforms:{size:[10,10],smoothness:.5},html_url:"https://gist.github.com/731fcad4f8956866f34a",created_at:"2014-05-16T13:52:46Z",updated_at:"2015-07-08T02:50:42Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform ivec2 size;uniform float smoothness;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float r=rand(floor(vec2(size)*p));float m=smoothstep(0.0,-smoothness,r-(progress*(1.0+smoothness)));gl_FragColor=mix(texture2D(from,p),texture2D(to,p),m);}"},{id:"df8797fd112e8e429064",name:"squeeze",owner:"gre",uniforms:{colorSeparation:.02},html_url:"https://gist.github.com/df8797fd112e8e429064",created_at:"2014-05-16T13:51:39Z",updated_at:"2015-07-08T02:57:38Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float colorSeparation;float progressY(float y){return 0.5+(y-0.5)/(1.0-progress);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float y=progressY(p.y);if(y<0.0||y>1.0){gl_FragColor=texture2D(to,p);}else{vec2 fp=vec2(p.x,y);vec3 c=vec3(texture2D(from,fp-progress*vec2(0.0,colorSeparation)).r,texture2D(from,fp).g,texture2D(from,fp+progress*vec2(0.0,colorSeparation)).b);gl_FragColor=vec4(c,1.0);}}"},{id:"90000743fedc953f11a4",name:"directionalwipe",owner:"gre",uniforms:{direction:[1,-1],smoothness:.5},html_url:"https://gist.github.com/90000743fedc953f11a4",created_at:"2014-05-16T13:50:51Z",updated_at:"2015-07-08T02:57:07Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform vec2 direction;uniform float smoothness;const vec2 center=vec2(0.5,0.5);void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec2 v=normalize(direction);v/=abs(v.x)+abs(v.y);float d=v.x*center.x+v.y*center.y;float m=smoothstep(-smoothness,0.0,v.x*p.x+v.y*p.y-(d-0.5+progress*(1.+smoothness)));gl_FragColor=mix(texture2D(to,p),texture2D(from,p),m);}"},{id:"7de3f4b9482d2b0bf7bb",name:"wind",owner:"gre",uniforms:{size:.2},html_url:"https://gist.github.com/7de3f4b9482d2b0bf7bb",created_at:"2014-05-16T13:49:36Z",updated_at:"2015-07-08T02:56:52Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float size;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float r=rand(vec2(0,p.y));float m=smoothstep(0.0,-size,p.x*(1.0-size)+size*r-(progress*(1.0+size)));gl_FragColor=mix(texture2D(from,p),texture2D(to,p),m);}"},{id:"d9f8b4df19584f1f0474",name:"fadegrayscale",owner:"gre",uniforms:{grayPhase:.3},html_url:"https://gist.github.com/d9f8b4df19584f1f0474",created_at:"2014-05-16T13:49:13Z",updated_at:"2015-07-08T02:51:17Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float grayPhase;vec3 grayscale(vec3 color){return vec3(0.2126*color.r+0.7152*color.g+0.0722*color.b);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;vec4 fc=texture2D(from,p);vec4 tc=texture2D(to,p);gl_FragColor=mix(mix(vec4(grayscale(fc.rgb),1.0),texture2D(from,p),smoothstep(1.0-grayPhase,0.0,progress)),mix(vec4(grayscale(tc.rgb),1.0),texture2D(to,p),smoothstep(grayPhase,1.0,progress)),progress);}"},{id:"206b96128ad6085f9911",name:"dispersionblur",owner:"gre",uniforms:{size:.6},html_url:"https://gist.github.com/206b96128ad6085f9911",created_at:"2014-05-16T13:47:09Z",updated_at:"2015-07-08T02:51:34Z",stars:1,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define QUALITY 32\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float size;const float GOLDEN_ANGLE=2.399963229728653;vec4 blur(sampler2D t,vec2 c,float radius){vec4 sum=vec4(0.0);float q=float(QUALITY);for(int i=0;i<QUALITY;++i){float fi=float(i);float a=fi*GOLDEN_ANGLE;float r=sqrt(fi/q)*radius;vec2 p=c+r*vec2(cos(a),sin(a));sum+=texture2D(t,p);}return sum/q;}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float inv=1.-progress;gl_FragColor=inv*blur(from,p,progress*size)+progress*blur(to,p,inv*size);}"},{id:"d71472a550601b96d69d",name:"heartwipe",owner:"gre",uniforms:{},html_url:"https://gist.github.com/d71472a550601b96d69d",created_at:"2014-05-16T13:46:31Z",updated_at:"2015-07-08T02:54:56Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;bool inHeart(vec2 p,vec2 center,float size){if(size==0.0) return false;vec2 o=(p-center)/(1.6*size);return pow(o.x*o.x+o.y*o.y-0.3,3.0)<o.x*o.x*pow(o.y,3.0);}void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float m=inHeart(p,vec2(0.5,0.4),progress)?1.0:0.0;gl_FragColor=mix(texture2D(from,p),texture2D(to,p),m);}"},{id:"f24651a01bf574e90122",name:"fadecolor",owner:"gre",uniforms:{color:[0,0,0],colorPhase:.4},html_url:"https://gist.github.com/f24651a01bf574e90122",created_at:"2014-05-16T13:45:46Z",updated_at:"2015-07-08T02:50:32Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform vec3 color;uniform float colorPhase;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;gl_FragColor=mix(mix(vec4(color,1.0),texture2D(from,p),smoothstep(1.0-colorPhase,0.0,progress)),mix(vec4(color,1.0),texture2D(to,p),smoothstep(colorPhase,1.0,progress)),progress);}"},{id:"35e8c18557995c77278e",name:"circleopen",owner:"gre",uniforms:{smoothness:.3,opening:!0},html_url:"https://gist.github.com/35e8c18557995c77278e",created_at:"2014-05-16T13:40:51Z",updated_at:"2015-07-08T02:57:16Z",stars:0,glsl:"\n#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D from;uniform sampler2D to;uniform float progress;uniform vec2 resolution;uniform float smoothness;uniform bool opening;const vec2 center=vec2(0.5,0.5);const float SQRT_2=1.414213562373;void main(){vec2 p=gl_FragCoord.xy/resolution.xy;float x=opening?progress:1.-progress;float m=smoothstep(-smoothness,0.0,SQRT_2*distance(center,p)-x*(1.+smoothness));gl_FragColor=mix(texture2D(from,p),texture2D(to,p),opening?1.-m:m);}"}]},{}],11:[function(e,t,r){function n(e){return u.lastIndex=0,u.test(e)?'"'+e.replace(u,function(e){var t=f[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function o(e,t,r){var i,u,f,c,h,p=s,d=t[e];switch(d&&"object"==typeof d&&"function"==typeof d.toJSON&&(d=d.toJSON(e)),"function"==typeof l&&(d=l.call(t,e,d)),typeof d){case"string":return n(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(s+=a,h=[],"[object Array]"===Object.prototype.toString.apply(d)){for(c=d.length,i=0;c>i;i+=1)h[i]=o(i,d,r)||"null";return f=0===h.length?"[]":s?s.length+h.join(", ").length+4>r?"[\n"+s+h.join(",\n"+s)+"\n"+p+"]":"[ "+h.join(", ")+" ]":"["+h.join(",")+"]",s=p,f}if(l&&"object"==typeof l)for(c=l.length,i=0;c>i;i+=1)"string"==typeof l[i]&&(u=l[i],f=o(u,d,r),f&&h.push(n(u)+(s?": ":":")+f));else for(u in d)Object.prototype.hasOwnProperty.call(d,u)&&(f=o(u,d,r),f&&h.push(n(u)+(s?": ":":")+f));return f=0===h.length?"{}":s?s.length+h.join(", ").length+4>r?"{\n"+s+h.join(",\n"+s)+"\n"+p+"}":"{ "+h.join(", ")+" }":"{"+h.join(",")+"}",s=p,f}}function i(e,t,r,n){var i;if(s="",a="",n||(n=0),"number"!=typeof n)throw new Error("beaufifier: limit must be a number");if("number"==typeof r)for(i=0;r>i;i+=1)a+=" ";else"string"==typeof r&&(a=r);if(l=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("beautifier: wrong replacer parameter");return o("",{"":e},n)}var s,a,l,u=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};t.exports=i},{}],12:[function(e,t,r){t.exports=e("./lib/Diaporama")},{"./lib/Diaporama":14}],13:[function(e,t,r){t.exports={TRANSITION:0,KENBURNS:[1,2,3],SLIDE2D:[4,5,6],sort:function(e,t){return e-t}}},{}],14:[function(e,t,r){function n(e,t){return m.sort(e[1].channel,t[1].channel)}function o(e){if(l||(l=new w),e){if("webgl"===e||"canvas"===e)return l.supported()?"webgl":null}else e=l.supported()?"webgl":"dom";return e}function i(e,t,r,n){switch(n){case"webgl":return new _(e,t,r);case"dom":return new y(e,t,r)}return null}function s(e,t,r,n,o){var i=D(r/n)+r*o/(t-e);return e+(t-e)*Math.max(0,Math.min(i,1))}function a(e,t,r){if(!(this instanceof a))return new a(e,t,r);if(!e||!e.nodeType)throw new Error("Diaporama: a DOM container is required.");if(t&&!r&&t.data&&(r=t,t=null),r||(r={}),this._segments=[],this._runningSegments=[],this._renderingMode=o(r.renderingMode),!this._renderingMode)throw new Error("No rendering is suitable for renderingMode="+r.renderingMode);var n=new d(p.fallbackBlack(p.timeout(p.loader,r.networkTimeout||6e4)));this._rendering=i(n,e,r.backgroundColor||this._backgroundColor,this._renderingMode),delete r.renderingMode,delete r.backgroundColor,this._handleResize=this._handleResize.bind(this),this._handleRender=this._handleRender.bind(this),this._container=e;for(var s in r)this[s]=r[s];t&&(this.data=t),(null===this._width||null===this._height)&&this.fitToContainer();var l=this;this.once("canplay",function(){l.renderNow()}),this.once("canplaythrough",function(){l._autoplay?l._start():l._requestRender()}),this._requestResize()}var l,u=e("raf"),f=e("events").EventEmitter,c=e("object-assign"),h=e("bezier-easing"),p=e("./loader"),d=e("./MediaLoader"),g=e("./hashResource"),m=e("./Channels"),v=e("./findTransitionByName"),_=e("./DiaporamaRenderingCanvas"),y=e("./DiaporamaRenderingDOM"),b=e("./TimeInterval"),x=e("./DiaporamaFormatError"),w=e("./WebGLDetector"),E=e("./forEachSlide2dImage"),T=0,C=1,A=2,D=h(.4,0,.8,1);a.prototype=c({},f.prototype,{destroy:function(){this._destroyed||(this._destroyed=!0,this.emit("destroy"),this.removeAllListeners(),this._stopCurrentDiaporamaLoading&&(this._stopCurrentDiaporamaLoading(),this._stopCurrentDiaporamaLoading=null),this._stop(),this._destroySegments(this._segments),this._rendering.destroy())},play:function(){this.paused=!1},pause:function(){this.paused=!0},next:function(e){var t=this._slideIndexForTime(this._slidingTarget?this._slidingTarget.to:this._currentTime);if(-1!==t){if(t++,t>=this._slideTimes.length){if(!this._loop)return;t=0}this._slideToTime(this._slideTimes[t],e,!0)}},prev:function(e){var t=this._slideIndexForTime(this._slidingTarget?this._slidingTarget.to:this._currentTime);if(-1!==t){if(t--,0>t){if(!this._loop)return;t=this._slideTimes.length-1}this._slideToTime(this._slideTimes[t],e,!1)}},jump:function(e,t){if("number"!=typeof e)throw new Error("Diaporama#jump requires the slide index number.");if(!(0>e||e>=this._slideTimes.length)){var r=this._slideIndexForTime(this._currentTime);r!==e&&this._slideToTime(this._slideTimes[e],t)}},fitToContainer:function(){var e=this._container,t=e.getBoundingClientRect();this._width=t.width,this._height=t.height,this._requestResize()},_playbackRate:1,_loop:!1,_autoplay:!1,_paused:!0,_width:null,_height:null,_resolution:window.devicePixelRatio||1,_currentTime:0,_duration:0,_backgroundColor:[0,0,0],_curLoop:null,_startLoopId:0,_needResize:null,_needRender:null,_slidingTarget:null,_loadMedia:function(){function e(e){var t=g(e);t in h||(h[t]=e)}function t(){d||(d=1,u.emit("canplay"),u._requestRender())}function r(){m||(m=1,u.emit("canplaythrough"),u._requestRender())}function n(){u.emit("load"),u._requestRender()}function o(){for(var e=u._segments,t=u._rendering,r=e.length,n=0;r>n;++n){var o=e[n];if(o[0].timeInside(0)&&!o[1].ready(t))return!1}return!0}function i(){if(p.length===Object.keys(h).length)t(),r(),n(),l();else if(!d&&o()&&t(),d&&!m){var e=Date.now()-v,i=u.duration;.8*p.length/Object.keys(h).length>e/i&&r()}}function s(e){g(e)in h&&(u.emit("progress",p.length/Object.keys(h).length),p.push(e),i())}function a(e,t){u.emit("error",new Error("Failure to load "+e),t),l()}function l(){c.removeListener("load",s),c.removeListener("error",a),clearInterval(_)}this._stopCurrentDiaporamaLoading&&(this._stopCurrentDiaporamaLoading(),this._stopCurrentDiaporamaLoading=null);var u=this,f=this._rendering,c=f.media,h={},p=[];this._data.timeline.forEach(function(t){if(t.video){var r=u._resolve(t.video,"video");e(r)}else t.image?e({image:t.image}):t.slide2d&&E(t.slide2d.draws,function(t){e({image:t})})});var d,m;if(0===Object.keys(h).length)return void setTimeout(function(){t(),r(),n()},0);var v=Date.now();setTimeout(i,0);var _=setInterval(i,200);c.on("load",s),c.on("error",a);for(var y in h)c.load(h[y]);this._stopCurrentDiaporamaLoading=l},_loadTransitions:function(){var e=this._rendering.transitions;if(e){var t=this._data.transitions||{};this._data.timeline.forEach(function(r){var n=r.transitionNext&&r.transitionNext.name;if(n&&!e.has(n)){var o=v(n,t);o&&e.set(n,o)}})}},_requestResize:function(){null===this._needResize&&(this._needResize=u(this._handleResize))},_handleResize:function(){null!==this._needResize&&(this._needResize=null,this._resize())},_resize:function(){if(!this._destroyed){var e=this._width,t=this._height,r=this._resolution;this._rendering.resize(e,t,r);for(var n=0;n<this._runningSegments.length;++n)this._runningSegments[n][1].resize(e,t,r);this.emit("resize",e,t),this._requestRender()}},_destroySegments:function(e){for(var t;t=e.pop();)t[1].destroy&&t[1].destroy()},_computeTimelineSegments:function(){for(var e;e=this._runningSegments.pop();){var t=e[1].leave();t&&this.emit.apply(this,t)}this._destroySegments(this._segments);for(var r,o=this.loop,i=this._data,s=i.timeline.length,a=0,l=0,u=[],f=[],h=[],p=0;s>p;p++){u.push(a);var d=c({},i.timeline[p]),g=d.duration||0,v=d.transitionNext,_=v&&v.duration||0,y=p===s-1?2:p%2;if(d.video)d.video=this._resolve(d.video,"video"),0===p&&(r=new this._rendering.SegmentKenBurns(m.KENBURNS[y],d,this)),e=new this._rendering.SegmentKenBurns(m.KENBURNS[y],d,this);else if(d.image){if(d.image=this._resolve(d.image,"image"),0===p){var w=c({},d);w.kenburns=c({},w.kenburns),w.kenburns.to=w.kenburns.from,r=new this._rendering.SegmentKenBurns(m.KENBURNS[y],w,this)}e=new this._rendering.SegmentKenBurns(m.KENBURNS[y],d,this)}else{if(!d.slide2d)throw new x("timeline item can't be understood as a segment.",d);0===p&&(r=new this._rendering.SegmentSlide2d(m.SLIDE2D[y],d)),e=new this._rendering.SegmentSlide2d(m.SLIDE2D[y],d)}f.push([new b(a-l,o||p!==s-1?a+g+_:a+g),e]),l=_,a+=g,_&&(h.push({interval:new b(a,a+_),index:p}),a+=_)}for(var E=a-l,T=[],C=0;C<h.length;++C){var A=h[C],D=A.index,S=D+1<i.timeline.length?D+1:0,R=f[D][1],F=f[S][1],I=i.timeline[D].transitionNext;(0!==S||o)&&T.push([A.interval,new this._rendering.SegmentTransition(m.TRANSITION,I,R,F)])}if(o&&f.length){var L=f[0][0].clone();L.add(E),f.push([L,r])}f=T.concat(f),f.sort(n),this._slideTimes=u,this._segments=f,this._duration=E,this._lastTransitionDuration=l},_slideIndexForTime:function(e){var t=this._slideTimes;if(!t)return-1;e=this._normalizeTime(e);for(var r=t.length,n=0;r>n;++n)if(e<t[n])return n-1;return r-1},_slideToTime:function(e,t,r){var n=this._currentTime;if(e!==n){if(this._loop){var o=this.duration,i=Math.abs(e-n),s=Math.abs(e+o-n),a=Math.abs(e-o-n);void 0===r?(i>s||i>a)&&(a>s?e+=o:e-=o):r?i>s&&(e+=o):i>a&&(e-=o)}if(this.paused||!t)this._currentTime=e,this._requestRender();else{var l=this._playbackRate;this._slidingTarget={from:n,to:e,startTime:null,duration:t,initialPlaybackRate:e>n==l>0?l:0}}}},renderNow:function(){this._needRender=!0,this._handleRender()},_requestRender:function(){null===this._curLoop&&null===this._needRender&&(this._needRender=u(this._handleRender))},_handleRender:function(){null!==this._needRender&&(this._needRender=null,this._render())},_normalizeTime:function(e){var t=this.duration;return this._loop?t?(e+t)%t:0:Math.max(0,Math.min(e,t))},_render:function(){if(!this._destroyed){var e=this._rendering;this._handleResize();var t=this._segments;if(0===t.length)return e.render(0,[]),this.emit("render",0,T),T;var r,o,i=this._normalizeTime(this._currentTime),s=this._runningSegments,a=!1,l=[],u=[],f=t.length;for(r=0;f>r;++r){o=t[r];var c=s.indexOf(o),h=-1!==c;if(o[0].timeInside(i)){if(!h){if(!o[1].ready(e)){a=!0;continue}s.push(o),l.push(o[1])}}else h&&(s.splice(c,1),u.push(o[1]))}for(s.sort(n),r=u.length-1;r>=0;r--){o=u[r];var p=o.leave();p&&this.emit.apply(this,p)}for(r=l.length-1;r>=0;r--){o=l[r];var d=o.enter(e);d&&this.emit.apply(this,d)}(0===i||s.length>0)&&this._rendering.render(i,s)&&(a=!0);var g=s.length>0?a?C:A:T;return this.emit("render",i,g),this._userJump&&(this._userJump=!1,this.emit("seeked",i,g)),g}},_start:function(){var e,t=this,r=++this._startLoopId;this._curLoop=u(function n(o){if(t._startLoopId===r){u(n),e||(e=o,t.emit("play"));var i=o-e;e=o;var a=t._render();if(a===T)t.loop?t.currentTime=0:t._stop(!0);else if(a===A){var l=t._slidingTarget;if(null!==l){null===l.startTime&&(l.startTime=o);var f=o-l.startTime,c=s(l.from,l.to,f,l.duration,l.initialPlaybackRate);Math.abs(l.to-c)<10||f>=l.duration?(t._currentTime=l.to,t._slidingTarget=null):t._currentTime=c}else t._currentTime=t._normalizeTime(t._currentTime+i*t._playbackRate)}}})},_stop:function(e){this._startLoopId++,this._slidingTarget&&(this.currentTime=this._slidingTarget.endAt,this._slidingTarget=null),null!==this._curLoop&&(u.cancel(this._curLoop),this._curLoop=null,this.emit("pause"),e&&this.emit("ended"))},_resolve:function(e,t){var r=this.data;if(e="string"==typeof e&&r&&r.resources&&e in r.resources&&r.resources[e]||e,"string"==typeof e){var n={};n[t]=e,e=n}return e}}),Object.defineProperties(a.prototype,{loop:{set:function(e){var t=!!e;this._loop!==t&&(this._loop=t,this._data&&(this._computeTimelineSegments(this._data),this._requestRender()))},get:function(){return this._loop}},autoplay:{set:function(e){this._autoplay=e},get:function(){return this._autoplay}},data:{set:function(e){var t=this._data;t!==e&&(this._data=e,this._computeTimelineSegments(t),this._loadTransitions(),this._loadMedia(),this._requestRender())},get:function(){return this._data}},resolution:{set:function(e){e!==this._resolution&&(this._resolution=e,this._requestResize())},get:function(){return this._resolution}},width:{set:function(e){e!==this._width&&(this._width=e,this._requestResize())},get:function(){return this._width}},height:{set:function(e){e!==this._height&&(this._height=e,this._requestResize())},get:function(){return this._height}},currentTime:{set:function(e){e!==this._currentTime&&(this._userJump=!0,this._currentTime=this._normalizeTime(e),this._requestRender())},get:function(){return this._currentTime}},playbackRate:{set:function(e){this._playbackRate!==e&&(this._playbackRate=e,this.emit("ratechange",e))},get:function(){return this._playbackRate}},paused:{set:function(e){var t=null===this._curLoop;e!==t&&(e?this._stop():this._start())},get:function(){return null===this._curLoop}},duration:{get:function(){var e=this._duration||0;return this._loop?e+(this._lastTransitionDuration||0):e},set:function(){throw new Error("Diaporama: duration is a read-only value.")}},renderingMode:{get:function(){return this._renderingMode},set:function(){throw new Error("Diaporama: setting renderingMode afterwards is not supported.")}},backgroundColor:{get:function(){return this._backgroundColor},set:function(){throw new Error("Diaporama: setting backgroundColor afterwards is not supported.")}}}),a.RENDER_NO_SEGMENTS=T,a.RENDER_NOT_READY=C,a.RENDER_READY=A,t.exports=a},{"./Channels":13,"./DiaporamaFormatError":15,"./DiaporamaRenderingCanvas":20,"./DiaporamaRenderingDOM":23,"./MediaLoader":24,"./TimeInterval":28,"./WebGLDetector":29,"./findTransitionByName":30,"./forEachSlide2dImage":31,"./hashResource":32,"./loader":34,"bezier-easing":42,events:5,"object-assign":70,raf:71}],15:[function(e,t,r){function n(e,t){var r=Error.call(this,e);
this.name=r.name="DiaporamaFormatError",this.stack=r.stack,this.message=r.message,this.data=t}n.prototype=Object.create(Error.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t.exports=n},{}],16:[function(e,t,r){function n(e,t){this.gl=e,this.shader=o(e,a,l),this.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW);var r=t.concat([1]);this.background=s(e,i(new Float32Array(r.concat(r).concat(r).concat(r)),[2,2,4]))}var o=e("gl-shader"),i=e("ndarray"),s=e("gl-texture2d"),a=["attribute vec2 position;","varying vec2 uv;","void main() {","gl_Position = vec4(position,0.0,1.0);","uv = 0.5 * (position+1.0);","}"].join(""),l=["precision mediump float;","uniform sampler2D buffer;","varying vec2 uv;","void main() {","gl_FragColor = texture2D(buffer, uv);","}"].join("");n.prototype={dispose:function(){this.gl.deleteBuffer(this.buffer),this.background.dispose(),this.shader.dispose()},renderTexture:function(e){var t=this.gl,r=this.shader;r.bind(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),r.attributes.position.pointer(),r.uniforms.buffer=e.bind(),t.drawArrays(t.TRIANGLES,0,6)},renderFBO:function(e){this.renderTexture(e.color[0])},renderEmpty:function(){this.renderTexture(this.background)}},t.exports=n},{"gl-shader":44,"gl-texture2d":61,ndarray:67}],17:[function(e,t,r){function n(e,t,r,n){s.call(this,e,t),this.segmentFrom=r,this.segmentTo=n,this._p=0}var o=e("object-assign"),i=e("bezier-easing"),s=e("../SegmentTimeline");n.prototype=o({},s.prototype,{toString:function(){return"SegmentTransition("+this.channel+","+this.segmentFrom.channel+"~>"+this.segmentTo.channel+")"},ready:function(e){return this.segmentFrom.ready(e)&&this.segmentTo.ready(e)&&(!this.data.name||e.transitions.has(this.data.name))},enter:function(e){var t=this.data,r=e.transitions.getOrFade(t.name),n=e.getChannelContext(this.channel);return this.gl=n,this.from=e.getChannel(this.segmentFrom.channel),this.to=e.getChannel(this.segmentTo.channel),this.uniforms=o({},r.uniforms,t.uniforms||{}),this.duration=t.duration||1e3,this.easing=i.apply(null,t.easing||[0,0,1,1]),this.t=r.t,["transition",this.data,this.segmentFrom.data,this.segmentTo.data]},resize:function(){this.t.render(this._p,this.from,this.to,this.uniforms)},leave:function(){return["transitionEnd",this.data,this.segmentFrom.data,this.segmentTo.data]},render:function(e,t){var r=this._p=this.easing(t.interpolate(e));this.t.render(r,this.from,this.to,this.uniforms)}}),t.exports=n},{"../SegmentTimeline":27,"bezier-easing":42,"object-assign":70}],18:[function(e,t,r){function n(e,t,r){s.call(this,e,t,r)}var o=e("object-assign"),i=e("gl-texture2d"),s=e("../SegmentKenBurns");n.prototype=o({},s.prototype,{enter:function(e){var t=this.getMediaSize(),r=s.prototype.enter.apply(this,arguments);return this.texture=i(e.gl,[t.width,t.height]),this.texture.minFilter=this.texture.magFilter=e.gl.LINEAR,this.image&&this.texture.setPixels(this.image),r},leave:function(){return this.texture.dispose(),s.prototype.leave.apply(this,arguments)},draw:function(e,t){this.video&&this.texture.setPixels(e),this.kenburns.render(this.texture,t)}}),t.exports=n},{"../SegmentKenBurns":25,"gl-texture2d":61,"object-assign":70}],19:[function(e,t,r){function n(e){this.gl=e,this.ts={},this.set("fade",i)}var o=e("glsl-transition"),i=e("glsl-transition-fade");n.prototype={destroy:function(){for(var e in this.ts)this.ts[e].t.dispose();this.ts=null},has:function(e){return e in this.ts},set:function(e,t){var r=o(this.gl,t.glsl);this.ts[e]={t:r,uniforms:t.uniforms||{}}},get:function(e){return this.ts[e]},getOrFade:function(e){return e&&this.ts[e]||this.ts.fade}},t.exports=n},{"glsl-transition":63,"glsl-transition-fade":62}],20:[function(e,t,r){function n(e,t,r){this.media=e,this._container=t,this.bg=r.concat([1]),this._canvas=null,this._canvases={},this._textures={},this._ctxs={},this._fbos={},this._currentChannel=null;var n=this.shape=[1,1],u=e.getImageResolver(),f=document.createElement("canvas"),c=f.getContext("webgl");c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!1),this.gl=c,this._post=new l(c,r);var d=s(c,n);this._attachContext(p.TRANSITION,c,d),p.KENBURNS.forEach(function(e){var t=s(c,n),r=new o(c);this._attachContext(e,r,t)},this),p.SLIDE2D.forEach(function(e){var t=document.createElement("canvas"),r=t.getContext("2d");this._canvases[e]=t;var n=a(c,t);n.minFilter=n.magFilter=c.LINEAR,this._textures[e]=n,this._attachContext(e,i(r,u))},this),this._container.appendChild(this._canvas=f),this.transitions=new h(this.getChannelContext(p.TRANSITION))}var o=e("kenburns-webgl"),i=e("slide2d"),s=e("gl-fbo"),a=e("gl-texture2d"),l=e("./Post"),u=e("./SegmentGlslTransition"),f=e("./SegmentKenBurnsWebGL"),c=e("../SegmentSlide2d"),h=e("./StoreTransitions"),p=e("../Channels");n.prototype={SegmentTransition:u,SegmentKenBurns:f,SegmentSlide2d:c,destroy:function(){this.media.destroy(),this.transitions.destroy();for(var e in this._ctxs){var t=this._ctxs[e];t.destroy?t.destroy():t.dispose&&t.dispose()}for(var r in this._fbos)this._fbos[r].dispose();for(var n in this._textures)this._textures[n].dispose();this._post.dispose(),this._fbos=null,this._canvas=null,this._canvases=null,this._ctxs=null,this._post=null,this._currentChannel=null},getSize:function(){var e=this.shape;return{width:e[0],height:e[1]}},resize:function(e,t,r){var n=e*r,o=t*r,i=this.shape=[n,o],s=this._canvas,a=this._container;s.style.width=e+"px",s.style.height=t+"px",s.width=n,s.height=o,a.style.width=e+"px",a.style.height=t+"px";for(var l in this._canvases){var u=this._canvases[l];u.width=n,u.height=o}for(var f in this._fbos)this._fbos[f].shape=i;for(var c in this._textures)this._textures[c].shape=i},getChannel:function(e){var t=this._fbos[e];if(t)return t.color[0];var r=this._canvases[e],n=this._textures[e],o=this.gl;return o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),n.setPixels(r),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),n},getChannelContext:function(e){return this._ctxs[e]},switchChannel:function(e){this._currentChannel=e},_attachContext:function(e,t,r){this._ctxs[e]=t,r&&(this._fbos[e]=r)},preparePostRender:function(){var e=this.gl,t=this.bg,r=this.shape;e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,r[0],r[1]),e.clearColor.apply(e,t),e.clear(e.COLOR_BUFFER_BIT)},render:function(e,t){var r=!1;if(t.length>0){for(var n,o=t.length-1;o>=0;o--){var i=t[o],s=i[1],a=i[0];n=s.channel;var l=this._fbos[s.channel];l&&l.bind(),s.render(e,a)&&(r=!0)}this.preparePostRender(),this._post.renderTexture(this.getChannel(n))}else this.preparePostRender(),this._post.renderEmpty();return r}},t.exports=n},{"../Channels":13,"../SegmentSlide2d":26,"./Post":16,"./SegmentGlslTransition":17,"./SegmentKenBurnsWebGL":18,"./StoreTransitions":19,"gl-fbo":43,"gl-texture2d":61,"kenburns-webgl":66,slide2d:76}],21:[function(e,t,r){function n(e,t,r,n){s.call(this,e,t),this.segmentFrom=r,this.segmentTo=n}var o=e("object-assign"),i=e("bezier-easing"),s=e("../SegmentTimeline");n.prototype=o({},s.prototype,{toString:function(){return"SegmentTransition("+this.channel+","+this.segmentFrom.channel+"~>"+this.segmentTo.channel+")"},ready:function(e){return this.segmentFrom.ready(e)&&this.segmentTo.ready(e)},enter:function(e){var t=this.data,r=e.getChannel(this.segmentFrom.channel),n=e.getChannel(this.segmentTo.channel),o=e.getChannel(this.channel);return r.style.position="absolute",r.style.top=0,r.style.left=0,n.style.position="absolute",n.style.top=0,n.style.left=0,o.appendChild(n),o.appendChild(r),this.container=o,this.from=r,this.to=n,this.duration=t.duration||1e3,this.easing=i.apply(null,t.easing||[0,0,1,1]),["transition",t,this.segmentFrom.data,this.segmentTo.data]},resize:function(){},leave:function(){return this.container.removeChild(this.from),this.container.removeChild(this.to),this.from.style.opacity=1,this.to.style.opacity=1,["transitionEnd",this.data,this.segmentFrom.data,this.segmentTo.data]},render:function(e,t){var r=this.easing(t.interpolate(e));this.from.style.opacity=1-r}}),t.exports=n},{"../SegmentTimeline":27,"bezier-easing":42,"object-assign":70}],22:[function(e,t,r){function n(e,t,r){i.call(this,e,t,r)}var o=e("object-assign"),i=e("../SegmentKenBurns");n.prototype=o({},i.prototype,{enter:function(e){return this.div=e.getChannel(this.channel),this.getSize=e.getSize.bind(e),i.prototype.enter.apply(this,arguments)},draw:function(e,t){this.kenburns.draw(e,t)}}),t.exports=n},{"../SegmentKenBurns":25,"object-assign":70}],23:[function(e,t,r){function n(e,t,r){this.media=e,this._container=t;var n=this._container.style.position;n&&"static"!==n||(this._container.style.position="relative"),this._container.style.backgroundColor="rgb("+r.map(function(e){return~~(255*e)})+")",this._nodes={},this._ctxs={},this.createDOM(),this.resolveImage=e.getImageResolver()}var o=e("kenburns-dom"),i=e("slide2d"),s=e("../Channels"),a=e("./SegmentDomTransition"),l=e("./SegmentKenBurnsDOM"),u=e("../SegmentSlide2d");n.prototype={SegmentTransition:a,SegmentKenBurns:l,SegmentSlide2d:u,destroy:function(){this._setChild(null),this.media.destroy();for(var e in this._ctxs)this._ctxs[e].destroy&&this._ctxs[e].destroy();this._nodes=null,this._ctxs=null},resize:function(e,t,r){this._w=e,this._h=t;var n=e*r,o=t*r;for(var i in this._nodes){var s=this._nodes[i];s.style.width=e+"px",s.style.height=t+"px","CANVAS"===s.nodeName&&(s.width=n,s.height=o)}this._container.style.width=e+"px",this._container.style.height=t+"px"},getSize:function(){return{width:this._w,height:this._h}},getChannel:function(e){return this._nodes[e]},getChannelContext:function(e){return this._ctxs[e]},switchChannel:function(e){e!==this._c&&(this._c=e,this._setChild(this._nodes[e]))},render:function(e,t){var r=!1;if(t.length>0){for(var n=t.length-1;n>=0;n--){var o=t[n],i=o[1],s=o[0];i.render(e,s)&&(r=!0)}this.switchChannel(t[0][1].channel)}else this.switchChannel(null);return r},createDOM:function(){var e=this.resolveImage,t=document.createElement("div");this._attachChannel(s.TRANSITION,t,t),s.KENBURNS.forEach(function(e){var t=document.createElement("div"),r=new o(t);r.getViewport=this.getSize.bind(this),this._attachChannel(e,t,r)},this),s.SLIDE2D.forEach(function(t){var r=document.createElement("canvas"),n=r.getContext("2d");this._attachChannel(t,r,i(n,e))},this)},_attachChannel:function(e,t,r){this._nodes[e]=t,this._ctxs[e]=r},_setChild:function(e){var t=this._container,r=t.children[0];r&&t.removeChild(r),e&&t.appendChild(e)}},t.exports=n},{"../Channels":13,"../SegmentSlide2d":26,"./SegmentDomTransition":21,"./SegmentKenBurnsDOM":22,"kenburns-dom":64,slide2d:76}],24:[function(e,t,r){function n(e,t){this.loader=e,this.resources={},this._loading={},this._threshold=t||3,this._queue=[]}var o=e("object-assign"),i=e("events").EventEmitter,s=e("./hashResource");n.prototype=o({},i.prototype,{destroy:function(){this.removeAllListeners(),this.resources={};for(var e in this._loading)this._loading[e]();this._loading={},this._queue=[],this._imageResolver=function(e){var t=this.get(e);return t&&t.image||null}.bind(this)},has:function(e){return s(e)in this.resources},get:function(e){return this.resources[s(e)]},load:function(e){Object.keys(this._loading).length>=this._threshold?this._queue.push(e):this._load(e)},getImageResolver:function(){return this._imageResolver},_load:function(e){var t=s(e);if(!(t in this._loading)){var r=this;this._take(e,this.loader(e,function(n){r._release(e)&&(r.resources[t]=n,r.emit("load",e,n))},function(t){r.emit("error",e,t)}))}},_take:function(e,t){this._loading[s(e)]=t},_release:function(e){var t=s(e);return t in this._loading?(delete this._loading[t],this._queue.length>0&&this._load(this._queue.shift()),!0):!1}}),t.exports=n},{"./hashResource":32,events:5,"object-assign":70}],25:[function(e,t,r){function n(e,t,r){i.call(this,e,t),this.diaporama=r,this.outOfSync=!1,this.syncing=!1,this.video=null,this.image=null,this.opts=o({position:0,volume:0,playbackRate:1,loop:!1},t),this.onVideoSeeked=this.onVideoSeeked.bind(this),this.onDiaporamaPause=this.onDiaporamaPause.bind(this),this.onDiaporamaPlay=this.onDiaporamaPlay.bind(this),this.onDiaporamaRateChange=this.onDiaporamaRateChange.bind(this),this.onDiaporamaSeeked=this.onDiaporamaSeeked.bind(this),this.resKey=f(t.video||t.image),r[c]||(r[c]={}),r[c][this.resKey]||(this.isFirstInstance=!0,r[c][this.resKey]=!0)}var o=e("object-assign"),i=e("./SegmentTimeline"),s=e("rect-clamp"),a=e("rect-crop"),l=e("rect-mix"),u=e("bezier-easing"),f=e("./hashResource"),c="__skb_fi";n.prototype=o({},i.prototype,{toString:function(){return"SegmentKenBurns("+this.channel+")"},destroy:function(){this.isFirstInstance?delete this.diaporama[c][this.resKey]:this._res&&this._res(),this._res=null},_computeVideoMeta:function(){var e=this.video;this.videoDuration=e.duration,this.videoSize={width:e.videoWidth,height:e.videoHeight}},_setRes:function(e){e.video?(this.video=e.video,this._computeVideoMeta()):e.image&&(this.image=e.image)},_load:function(e){var t=e.media,r=this.data;if(!this._loadHandled){if(this.isFirstInstance){var n=t.get(r.image||r.video);return void(n&&(this._loadHandled=!0,this._setRes(n)))}this._loadHandled=!0,this._res=t.loader(r.video||r.image,this._setRes.bind(this))}},ready:function(e){return this._load(e),this.image||this.video},getMediaSize:function(){return this.image||this.videoSize},enter:function(e){this.outOfSync=!0,this.getSize=e.getSize.bind(e);var t=this.data,r=this.video,n=this.image,o=this.opts,i=this.getMediaSize();r&&(r.loop=o.loop,r.volume=o.volume,r.playbackRate=this.getPlaybackRate(),r.addEventListener("seeked",this.onVideoSeeked),this.diaporama.on("pause",this.onDiaporamaPause),this.diaporama.on("play",this.onDiaporamaPlay),this.diaporama.on("ratechange",this.onDiaporamaRateChange),this.diaporama.on("seeked",this.onDiaporamaSeeked));var s=e.getChannelContext(this.channel);this.kenburns=s;var l=a.largest,f=a.largest;return t.kenburns&&(t.kenburns.from&&(l=a.apply(null,t.kenburns.from)),t.kenburns.to&&(f=a.apply(null,t.kenburns.to))),this.from=l,this.to=f,this.easing=u.apply(null,t.kenburns&&t.kenburns.easing||[0,0,1,1]),this.viewport=[0,0,i.width,i.height],this.computeBounds(),s.runStart&&s.runStart(r||n),["slide",t]},leave:function(){var e=this.video;e&&(e.pause(),e.removeEventListener("seeked",this.onVideoSeeked),this.diaporama.removeListener("pause",this.onDiaporamaPause),this.diaporama.removeListener("play",this.onDiaporamaPlay),this.diaporama.removeListener("ratechange",this.onDiaporamaRateChange),this.diaporama.removeListener("seeked",this.onDiaporamaSeeked));var t=this.kenburns;return t.runEnd&&t.runEnd(),["slideEnd",this.data]},resize:function(){this.computeBounds()},getPlaybackRate:function(){return this.opts.playbackRate*this.diaporama.playbackRate},computeCurrentTime:function(e){var t=this.opts,r=this.getPlaybackRate();return(t.position+e*r)/1e3%this.videoDuration},onDiaporamaRateChange:function(){this.video.playbackRate=this.getPlaybackRate()},onDiaporamaSeeked:function(){this.outOfSync=!0},onDiaporamaPause:function(){this.outOfSync=!0,this.video.pause()},onDiaporamaPlay:function(){this.outOfSync=!0},onVideoSeeked:function(){this.syncing=!1,this.diaporama._requestRender()},setVideoTime:function(e){this.video.currentTime=e},getCurrentTimeDiff:function(e){var t=this.video,r=this.videoDuration,n=Math.abs((e-t.currentTime+r)%r);return n},render:function(e,t){var r=this.easing(t.interpolate(e)),n=this.video,o=this.image;if(n){var i=this.computeCurrentTime(t.relative(e)),a=this.diaporama.paused,u=this.getCurrentTimeDiff(i);a?u>.01&&this.setVideoTime(i):this.syncing||(this.outOfSync?(this.outOfSync=!1,this.syncing=!0,this.setVideoTime(i),a!==n.paused&&(a?n.pause():n.play())):a!==n.paused&&this.setVideoTime(i))}var f=l(this.fromCropBound,this.toCropBound,r);return f=s(f,this.viewport),this.draw(n||o,f),this.syncing},cropBound:function(e){var t=e(this.getSize(),this.getMediaSize());return t=s(t,this.viewport)},computeBounds:function(){this.fromCropBound=this.cropBound(this.from),this.toCropBound=this.cropBound(this.to)}}),t.exports=n},{"./SegmentTimeline":27,"./hashResource":32,"bezier-easing":42,"object-assign":70,"rect-clamp":73,"rect-crop":74,"rect-mix":75}],26:[function(e,t,r){function n(e,t){i.call(this,e,t),this.imgs=[],s(t.slide2d.draws,this.imgs.push,this.imgs),this._needRender=!1}var o=e("object-assign"),i=e("./SegmentTimeline"),s=e("./forEachSlide2dImage");n.prototype=o({},i.prototype,{toString:function(){return"SegmentSlide2d("+this.channel+")"},ready:function(e){for(var t=0;t<this.imgs.length;++t)if(!e.media.has({image:this.imgs[t]}))return!1;return!0},enter:function(e){return this.ctx=e.getChannelContext(this.channel),this._render(),["slide",this.data]},resize:function(){this._needRender=!0},leave:function(){return["slideEnd",this.data]},render:function(){this._needRender&&this._render()},_render:function(){this._needRender=!1,this.ctx.render(this.data.slide2d)}}),t.exports=n},{"./SegmentTimeline":27,"./forEachSlide2dImage":31,"object-assign":70}],27:[function(e,t,r){function n(e,t){this.channel=e,this.data=t}var o=e("./noop");n.prototype={toString:function(){return"SegmentTimeline("+this.channel+")"},ready:function(){return!0},enter:o,leave:o,render:o,resize:o},t.exports=n},{"./noop":41}],28:[function(e,t,r){function n(e,t){this.startT=e,this.endT=t}var o=e("./mix");n.prototype={toString:function(){return"TimeInterval("+this.startT+","+this.endT+")"},clone:function(){return new n(this.startT,this.endT)},add:function(e){this.startT+=e,this.endT+=e},timeInside:function(e){return this.startT<=e&&e<this.endT},interpolate:function(e){return o(this.startT,this.endT,e)},relative:function(e){return e-this.startT}},t.exports=n},{"./mix":40}],29:[function(e,t,r){function n(){this.canvas=document.createElement("canvas"),this.canvas.addEventListener("webglcontextlost",function(e){e.preventDefault(),this.gl=null}.bind(this),!1)}var o=e("webglew");n.prototype={supported:function(){if(this.gl||(this.gl=this.canvas.getContext("webgl")),!this.gl)return!1;var e=o(this.gl);return e.OES_texture_float}},t.exports=n},{webglew:79}],30:[function(e,t,r){t.exports=function(e,t){for(var r=0;r<t.length;++r)if(t[r].name.toLowerCase()===e.toLowerCase())return t[r]}},{}],31:[function(e,t,r){t.exports=function n(e,t,r){e.forEach(function(e){e instanceof Array&&("object"==typeof e[0]?n(e,t,r):"drawImage"===e[0]&&t.call(r,e[1]))})}},{}],32:[function(e,t,r){t.exports=function(e){return JSON.stringify(e)}},{}],33:[function(e,t,r){var n=new Image;n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNg+A8AAQIBANEay48AAAAASUVORK5CYII=",t.exports=function(e){return function(t,r){return e(t,r,function(){r({image:n})})}}},{}],34:[function(e,t,r){var n=e("./fallbackBlack"),o=e("./timeout"),i=e("./loader");t.exports={loader:i,fallbackBlack:n,timeout:o}},{"./fallbackBlack":33,"./loader":38,"./timeout":39}],35:[function(e,t,r){t.exports=function(e,t,r){var n=new window.Image;return n.crossOrigin=!0,n.onload=function(){t(n)},n.onabort=n.onerror=r,n.src=e,function(){n.onload=null,n.onerror=null,n.onabort=null,n.src="",n=null}}},{}],36:[function(e,t,r){var n=e("object-assign"),o=e("./loadImage");t.exports=function i(e,t,r){"string"==typeof e&&(e={"":e});var s,a=Object.keys(e);return 0===a.length?r(new Error("all images failed to load")):s=o(e[a[0]],function(e){s&&(s=null,t(e))},function(o){s&&(1===a.length?(s=null,r(o)):(e=n({},e),delete e[a[0]],s=i(e,t,r)))}),function(){s&&(s(),s=null)}}},{"./loadImage":35,"object-assign":70}],37:[function(e,t,r){t.exports=function(e,t,r){function n(e){o||(o=null),s.networkState===i&&r(e)}var o=null,i=HTMLMediaElement.NETWORK_NO_SOURCE,s=document.createElement("video"),a=function(){s.removeEventListener("canplaythrough",a),t(s)};s.crossOrigin=!0,s.addEventListener("canplaythrough",a,!1);var l=[];for(var u in e){var f=e[u],c=document.createElement("source");c.addEventListener("error",n),"video"!==u&&(c.type=u),c.src=f,l.push(c),s.appendChild(c)}return s.load(),o=function(){l.forEach(function(){c.removeEventListener("error",n),c.src=""}),s.removeEventListener("canplaythrough",a),s.pause(),s.src="",s.innerHTML="",s=null,l=null},function(){o&&(o(),o=null)}}},{}],38:[function(e,t,r){var n=e("./loadImages"),o=e("./loadVideo");t.exports=function(e,t,r){function i(){s=n(l,function(e){s||(s=null),s=null,t({image:e})},function(e){s||(s=null),s=null,r(e)})}var s=null;"string"==typeof e&&(e={"":e});var a={},l={};for(var u in e){var f=e[u];0===u.indexOf("image")?l[u]=f:a[u]=f}return 0===Object.keys(a).length?i():s=o(a,function(e){t({video:e})},function(e){Object.keys(l).length?i():r(e)}),function(){s&&(s(),s=null)}}},{"./loadImages":36,"./loadVideo":37}],39:[function(e,t,r){t.exports=function(e,t){return function(r,n,o){var i,s=setTimeout(function(){i(),o(new Error("Timeout reached"))},t);return i=e(r,function(e){clearTimeout(s),n(e)},function(e){clearTimeout(s),o(e)}),function(){clearTimeout(s),i()}}}},{}],40:[function(e,t,r){t.exports=function(e,t,r){return Math.max(0,Math.min(1,(r-e)/(t-e)))}},{}],41:[function(e,t,r){t.exports=function(){}},{}],42:[function(e,t,r){!function(e){"object"==typeof r?t.exports=e():"function"==typeof define&&define.amd?define([],e):window.BezierEasing=e()}(function(){function e(e,t){return 1-3*t+3*e}function t(e,t){return 3*t-6*e}function r(e){return 3*e}function n(n,o,i){return((e(o,i)*n+t(o,i))*n+r(o))*n}function o(n,o,i){return 3*e(o,i)*n*n+2*t(o,i)*n+r(o)}function i(e,t,r,o,i){var s,a,l=0;do a=t+(r-t)/2,s=n(a,o,i)-e,s>0?r=a:t=a;while(Math.abs(s)>f&&++l<c);return a}function s(e,t,r,s){function a(t,i){for(var s=0;l>s;++s){var a=o(i,e,r);if(0===a)return i;var u=n(i,e,r)-t;i-=u/a}return i}function f(){for(var t=0;h>t;++t)v[t]=n(t*p,e,r)}function c(t){for(var n=0,s=1,l=h-1;s!=l&&v[s]<=t;++s)n+=p;--s;var f=(t-v[s])/(v[s+1]-v[s]),c=n+f*p,d=o(c,e,r);return d>=u?a(t,c):0===d?c:i(t,n,n+p,e,r)}function g(){_=!0,(e!=t||r!=s)&&f()}if(4!==arguments.length)throw new Error("BezierEasing requires 4 arguments.");for(var m=0;4>m;++m)if("number"!=typeof arguments[m]||isNaN(arguments[m])||!isFinite(arguments[m]))throw new Error("BezierEasing arguments should be integers.");if(0>e||e>1||0>r||r>1)throw new Error("BezierEasing x values must be in [0, 1] range.");var v=d?new Float32Array(h):new Array(h),_=!1,y=function(o){return _||g(),e===t&&r===s?o:0===o?0:1===o?1:n(c(o),t,s)};y.getControlPoints=function(){return[{x:e,y:t},{x:r,y:s}]};var b=[e,t,r,s],x="BezierEasing("+b+")";y.toString=function(){return x};var w="cubic-bezier("+b+")";return y.toCSS=function(){return w},y}var a=this,l=4,u=.001,f=1e-7,c=10,h=11,p=1/(h-1),d="Float32Array"in a;return s.css={ease:s(.25,.1,.25,1),linear:s(0,0,1,1),"ease-in":s(.42,0,1,1),"ease-out":s(0,0,.58,1),"ease-in-out":s(.42,0,.58,1)},s})},{}],43:[function(e,t,r){"use strict";function n(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING),r=e.getParameter(e.RENDERBUFFER_BINDING),n=e.getParameter(e.TEXTURE_BINDING_2D);return[t,r,n]}function o(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]),e.bindRenderbuffer(e.RENDERBUFFER,t[1]),e.bindTexture(e.TEXTURE_2D,t[2])}function i(e,t){var r=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);_=new Array(r+1);for(var n=0;r>=n;++n){for(var o=new Array(r),i=0;n>i;++i)o[i]=e.COLOR_ATTACHMENT0+i;for(var i=n;r>i;++i)o[i]=e.NONE;_[n]=o}}function s(e){switch(e){case d:throw new Error("gl-fbo: Framebuffer unsupported");case g:throw new Error("gl-fbo: Framebuffer incomplete attachment");case m:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case v:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function a(e,t,r,n,o,i){if(!n)return null;var s=p(e,t,r,o,n);return s.magFilter=e.NEAREST,s.minFilter=e.NEAREST,s.mipSamples=1,s.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,i,e.TEXTURE_2D,s.handle,0),s}function l(e,t,r,n,o){var i=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,n,t,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,o,e.RENDERBUFFER,i),i}function u(e){var t=n(e.gl),r=e.gl,i=e.handle=r.createFramebuffer(),u=e._shape[0],f=e._shape[1],c=e.color.length,h=e._ext,p=e._useStencil,d=e._useDepth,g=e._colorType;r.bindFramebuffer(r.FRAMEBUFFER,i);for(var m=0;c>m;++m)e.color[m]=a(r,u,f,g,r.RGBA,r.COLOR_ATTACHMENT0+m);0===c?(e._color_rb=l(r,u,f,r.RGBA4,r.COLOR_ATTACHMENT0),h&&h.drawBuffersWEBGL(_[0])):c>1&&h.drawBuffersWEBGL(_[c]);var v=r.getExtension("WEBGL_depth_texture");v?p?e.depth=a(r,u,f,v.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT):d&&(e.depth=a(r,u,f,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)):d&&p?e._depth_rb=l(r,u,f,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT):d?e._depth_rb=l(r,u,f,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT):p&&(e._depth_rb=l(r,u,f,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT));var y=r.checkFramebufferStatus(r.FRAMEBUFFER);if(y!==r.FRAMEBUFFER_COMPLETE){e._destroyed=!0,r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(e.handle),e.handle=null,e.depth&&(e.depth.dispose(),e.depth=null),e._depth_rb&&(r.deleteRenderbuffer(e._depth_rb),e._depth_rb=null);for(var m=0;m<e.color.length;++m)e.color[m].dispose(),e.color[m]=null;e._color_rb&&(r.deleteRenderbuffer(e._color_rb),e._color_rb=null),o(r,t),s(y)}o(r,t)}function f(e,t,r,n,o,i,s,a){this.gl=e,this._shape=[0|t,0|r],this._destroyed=!1,this._ext=a,this.color=new Array(o);for(var l=0;o>l;++l)this.color[l]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=n,this._useDepth=i,this._useStencil=s;var f=this,c=[0|t,0|r];Object.defineProperties(c,{0:{get:function(){return f._shape[0]},set:function(e){return f.width=e}},1:{get:function(){return f._shape[1]},set:function(e){return f.height=e}}}),this._shapeVector=c,u(this)}function c(e,t,r){if(e._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(e._shape[0]!==t||e._shape[1]!==r){var i=e.gl,a=i.getParameter(i.MAX_RENDERBUFFER_SIZE);if(0>t||t>a||0>r||r>a)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");e._shape[0]=t,e._shape[1]=r;for(var l=n(i),u=0;u<e.color.length;++u)e.color[u].shape=e._shape;e._color_rb&&(i.bindRenderbuffer(i.RENDERBUFFER,e._color_rb),i.renderbufferStorage(i.RENDERBUFFER,i.RGBA4,e._shape[0],e._shape[1])),e.depth&&(e.depth.shape=e._shape),e._depth_rb&&(i.bindRenderbuffer(i.RENDERBUFFER,e._depth_rb),e._useDepth&&e._useStencil?i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e._shape[0],e._shape[1]):e._useDepth?i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e._shape[0],e._shape[1]):e._useStencil&&i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX,e._shape[0],e._shape[1])),i.bindFramebuffer(i.FRAMEBUFFER,e.handle);var f=i.checkFramebufferStatus(i.FRAMEBUFFER);f!==i.FRAMEBUFFER_COMPLETE&&(e.dispose(),o(i,l),s(f)),o(i,l)}}function h(e,t,r,n){d||(d=e.FRAMEBUFFER_UNSUPPORTED,g=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,m=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,v=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var o=e.getExtension("WEBGL_draw_buffers");if(!_&&o&&i(e,o),Array.isArray(t)&&(n=r,r=0|t[1],t=0|t[0]),"number"!=typeof t)throw new Error("gl-fbo: Missing shape parameter");var s=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(0>t||t>s||0>r||r>s)throw new Error("gl-fbo: Parameters are too large for FBO");n=n||{};var a=1;if("color"in n){if(a=Math.max(0|n.color,0),0>a)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(a>1){if(!o)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(a>e.getParameter(o.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+a+" draw buffers")}}var l=e.UNSIGNED_BYTE,u=e.getExtension("OES_texture_float");if(n["float"]&&a>0){if(!u)throw new Error("gl-fbo: Context does not support floating point textures");l=e.FLOAT}else n.preferFloat&&a>0&&u&&(l=e.FLOAT);var c=!0;"depth"in n&&(c=!!n.depth);var h=!1;return"stencil"in n&&(h=!!n.stencil),new f(e,t,r,l,a,c,h,o)}var p=e("gl-texture2d");t.exports=h;var d,g,m,v,_=null,y=f.prototype;Object.defineProperties(y,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(e){if(Array.isArray(e)||(e=[0|e,0|e]),2!==e.length)throw new Error("gl-fbo: Shape vector must be length 2");var t=0|e[0],r=0|e[1];return c(this,t,r),[t,r]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(e){return e=0|e,c(this,e,this._shape[1]),e},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(e){return e=0|e,c(this,this._shape[0],e),e},enumerable:!1}}),y.bind=function(){if(!this._destroyed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle),e.viewport(0,0,this._shape[0],this._shape[1])}},y.dispose=function(){if(!this._destroyed){this._destroyed=!0;var e=this.gl;e.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(e.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var t=0;t<this.color.length;++t)this.color[t].dispose(),this.color[t]=null;this._color_rb&&(e.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":61}],44:[function(e,t,r){"use strict";function n(e){this.gl=e,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function o(e,t){return e.name<t.name?-1:1}function i(e,t,r,o,i){var s=new n(e);return s.update(t,r,o,i),s}var s=e("./lib/create-uniforms"),a=e("./lib/create-attributes"),l=e("./lib/reflect"),u=e("./lib/shader-cache"),f=e("./lib/runtime-reflect"),c=n.prototype;c.bind=function(){this.program||this._relink(),this.gl.useProgram(this.program)},c.dispose=function(){this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},c.update=function(e,t,r,n){function i(){h.program=u.program(p,h._vref,h._fref,y,b);for(var e=0;e<r.length;++e)D[e]=p.getUniformLocation(h.program,r[e].name)}if(!t||1===arguments.length){var c=e;e=c.vertex,t=c.fragment,r=c.uniforms,n=c.attributes}var h=this,p=h.gl,d=h._vref;h._vref=u.shader(p,p.VERTEX_SHADER,e),d&&d.dispose(),h.vertShader=h._vref.shader;var g=this._fref;if(h._fref=u.shader(p,p.FRAGMENT_SHADER,t),g&&g.dispose(),h.fragShader=h._fref.shader,!r||!n){var m=p.createProgram();if(p.attachShader(m,h.fragShader),p.attachShader(m,h.vertShader),p.linkProgram(m),!p.getProgramParameter(m,p.LINK_STATUS)){var v=p.getProgramInfoLog(m);throw console.error("gl-shader: Error linking program:",v),new Error("gl-shader: Error linking program:"+v)}r=r||f.uniforms(p,m),n=n||f.attributes(p,m),p.deleteProgram(m)}n=n.slice(),n.sort(o);for(var _=[],y=[],b=[],x=0;x<n.length;++x){var w=n[x];if(w.type.indexOf("mat")>=0){for(var E=0|w.type.charAt(w.type.length-1),T=new Array(E),C=0;E>C;++C)T[C]=b.length,y.push(w.name+"["+C+"]"),"number"==typeof w.location?b.push(w.location+C):Array.isArray(w.location)&&w.location.length===E&&"number"==typeof w.location[C]?b.push(0|w.location[C]):b.push(-1);_.push({name:w.name,type:w.type,locations:T})}else _.push({name:w.name,type:w.type,locations:[b.length]}),y.push(w.name),"number"==typeof w.location?b.push(0|w.location):b.push(-1)}for(var A=0,x=0;x<b.length;++x)if(b[x]<0){for(;b.indexOf(A)>=0;)A+=1;b[x]=A}var D=new Array(r.length);i(),h._relink=i,h.types={uniforms:l(r),attributes:l(n)},h.attributes=a(p,h,_,b),Object.defineProperty(h,"uniforms",s(p,h,r,D))},t.exports=i},{"./lib/create-attributes":45,"./lib/create-uniforms":46,"./lib/reflect":47,"./lib/runtime-reflect":48,"./lib/shader-cache":49}],45:[function(e,t,r){"use strict";function n(e,t,r,n,o,i){this._gl=e,this._wrapper=t,this._index=r,this._locations=n,this._dimension=o,this._constFunc=i}function o(e,t,r,o,i,s,a){for(var l=["gl","v"],u=[],f=0;i>f;++f)l.push("x"+f),u.push("x"+f);l.push("if(x0.length===void 0){return gl.vertexAttrib"+i+"f(v,"+u.join()+")}else{return gl.vertexAttrib"+i+"fv(v,x0)}");var c=Function.apply(null,l),h=new n(e,t,r,o,i,c);
Object.defineProperty(s,a,{set:function(t){return e.disableVertexAttribArray(o[r]),c(e,o[r],t),t},get:function(){return h},enumerable:!0})}function i(e,t,r,n,i,s,a){for(var l=new Array(i),u=new Array(i),f=0;i>f;++f)o(e,t,r[f],n,i,l,f),u[f]=l[f];Object.defineProperty(l,"location",{set:function(e){if(Array.isArray)for(var t=0;i>t;++t)u[t].location=e[t];else for(var t=0;i>t;++t)result[t]=u[t].location=e+t;return e},get:function(){for(var e=new Array(i),t=0;i>t;++t)e[t]=n[r[t]];return e},enumerable:!0}),l.pointer=function(t,o,s,a){t=t||e.FLOAT,o=!!o,s=s||i*i,a=a||0;for(var l=0;i>l;++l){var u=n[r[l]];e.vertexAttribPointer(u,i,t,o,s,a+l*i),e.enableVertexAttribArray(u)}};var c=new Array(i),h=e["vertexAttrib"+i+"fv"];Object.defineProperty(s,a,{set:function(t){for(var o=0;i>o;++o){var s=n[r[o]];if(e.disableVertexAttribArray(s),Array.isArray(t[0]))h.call(e,s,t[o]);else{for(var a=0;i>a;++a)c[a]=t[i*o+a];h.call(e,s,c)}}return t},get:function(){return l},enumerable:!0})}function s(e,t,r,n){for(var s={},a=0,l=r.length;l>a;++a){var u=r[a],f=u.name,c=u.type,h=u.locations;switch(c){case"bool":case"int":case"float":o(e,t,h[0],n,1,s,f);break;default:if(c.indexOf("vec")>=0){var p=c.charCodeAt(c.length-1)-48;if(2>p||p>4)throw new Error("gl-shader: Invalid data type for attribute "+f+": "+c);o(e,t,h[0],n,p,s,f)}else{if(!(c.indexOf("mat")>=0))throw new Error("gl-shader: Unknown data type for attribute "+f+": "+c);var p=c.charCodeAt(c.length-1)-48;if(2>p||p>4)throw new Error("gl-shader: Invalid data type for attribute "+f+": "+c);i(e,t,h,n,p,s,f)}}}return s}t.exports=s;var a=n.prototype;a.pointer=function(e,t,r,n){var o=this,i=o._gl,s=o._locations[o._index];i.vertexAttribPointer(s,o._dimension,e||i.FLOAT,!!t,r||0,n||0),i.enableVertexAttribArray(s)},a.set=function(e,t,r,n){return this._constFunc(this._locations[this._index],e,t,r,n)},Object.defineProperty(a,"location",{get:function(){return this._locations[this._index]},set:function(e){return e!==this._locations[this._index]&&(this._locations[this._index]=0|e,this._wrapper.program=null),0|e}})},{}],46:[function(e,t,r){"use strict";function n(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t){for(var r=new Array(e),n=0;e>n;++n)r[n]=t;return r}function i(e,t,r,i){function a(r){var n=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+r+"])}");return n(e,t,i)}function l(e,t,r){switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var n=r.indexOf("vec");if(!(n>=0&&1>=n&&r.length===4+n)){if(0===r.indexOf("mat")&&4===r.length){var o=r.charCodeAt(r.length-1)-48;if(2>o||o>4)throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+r);return"gl.uniformMatrix"+o+"fv(locations["+t+"],false,obj"+e+")"}throw new Error("gl-shader: Unknown uniform data type for "+name+": "+r)}var o=r.charCodeAt(r.length-1)-48;if(2>o||o>4)throw new Error("gl-shader: Invalid data type");switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+o+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+o+"fv(locations["+t+"],obj"+e+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+r)}}}function u(e,t){if("object"!=typeof t)return[[e,t]];var r=[];for(var n in t){var o=t[n],i=e;i+=parseInt(n)+""===n?"["+n+"]":"."+n,"object"==typeof o?r.push.apply(r,u(i,o)):r.push([i,o])}return r}function f(t){for(var n=["return function updateProperty(obj){"],o=u("",t),s=0;s<o.length;++s){var a=o[s],f=a[0],c=a[1];i[c]&&n.push(l(f,c,r[c].type))}n.push("return obj}");var h=new Function("gl","locations",n.join("\n"));return h(e,i)}function c(e){switch(e){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(t>=0&&1>=t&&e.length===4+t){var r=e.charCodeAt(e.length-1)-48;if(2>r||r>4)throw new Error("gl-shader: Invalid data type");return"b"===e.charAt(0)?o(r,!1):o(r,0)}if(0===e.indexOf("mat")&&4===e.length){var r=e.charCodeAt(e.length-1)-48;if(2>r||r>4)throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+e);return o(r*r,0)}throw new Error("gl-shader: Unknown uniform data type for "+name+": "+e)}}function h(e,t,o){if("object"==typeof o){var s=p(o);Object.defineProperty(e,t,{get:n(s),set:f(o),enumerable:!0,configurable:!1})}else i[o]?Object.defineProperty(e,t,{get:a(o),set:f(o),enumerable:!0,configurable:!1}):e[t]=c(r[o].type)}function p(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var r=0;r<e.length;++r)h(t,r,e[r])}else{t={};for(var n in e)h(t,n,e[n])}return t}var d=s(r,!0);return{get:n(p(d)),set:f(d),enumerable:!0,configurable:!0}}var s=e("./reflect");t.exports=i},{"./reflect":47}],47:[function(e,t,r){"use strict";function n(e,t){for(var r={},n=0;n<e.length;++n)for(var o=e[n].name,i=o.split("."),s=r,a=0;a<i.length;++a){var l=i[a].split("[");if(l.length>1){l[0]in s||(s[l[0]]=[]),s=s[l[0]];for(var u=1;u<l.length;++u){var f=parseInt(l[u]);u<l.length-1||a<i.length-1?(f in s||(u<l.length-1?s[f]=[]:s[f]={}),s=s[f]):t?s[f]=n:s[f]=e[n].type}}else a<i.length-1?(l[0]in s||(s[l[0]]={}),s=s[l[0]]):t?s[l[0]]=n:s[l[0]]=e[n].type}return r}t.exports=n},{}],48:[function(e,t,r){"use strict";function n(e,t){if(!a){var r=Object.keys(s);a={};for(var n=0;n<r.length;++n){var o=r[n];a[e[o]]=s[o]}}return a[t]}function o(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=[],i=0;r>i;++i){var s=e.getActiveUniform(t,i);if(s){var a=n(e,s.type);if(s.size>1)for(var l=0;l<s.size;++l)o.push({name:s.name.replace("[0]","["+l+"]"),type:a});else o.push({name:s.name,type:a})}}return o}function i(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=[],i=0;r>i;++i){var s=e.getActiveAttrib(t,i);s&&o.push({name:s.name,type:n(e,s.type)})}return o}r.uniforms=o,r.attributes=i;var s={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null},{}],49:[function(e,t,r){"use strict";function n(e,t,r,n,o,i,s){this.id=e,this.src=t,this.type=r,this.shader=n,this.count=i,this.programs=[],this.cache=s}function o(e){this.gl=e,this.shaders=[{},{}],this.programs={}}function i(e,t,r){var n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(n);throw console.error("gl-shader: Error compiling shader:",o),new Error("gl-shader: Error compiling shader:"+o)}return n}function s(e,t,r,n,o){var i=e.createProgram();e.attachShader(i,t),e.attachShader(i,r);for(var s=0;s<n.length;++s)e.bindAttribLocation(i,o[s],n[s]);if(e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){var a=e.getProgramInfoLog(i);throw console.error("gl-shader: Error linking program:",a),new Error("gl-shader: Error linking program:"+a)}return i}function a(e){var t=c.get(e);return t||(t=new o(e),c.set(e,t)),t}function l(e,t,r){return a(e).getShaderReference(t,r)}function u(e,t,r,n,o){return a(e).getProgram(t,r,n,o)}r.shader=l,r.program=u;var f="undefined"==typeof WeakMap?e("weakmap-shim"):WeakMap,c=new f,h=0;n.prototype.dispose=function(){if(0===--this.count){for(var e=this.cache,t=e.gl,r=this.programs,n=0,o=r.length;o>n;++n){var i=e.programs[r[n]];i&&(delete e.programs[n],t.deleteProgram(i))}t.deleteShader(this.shader),delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};var p=o.prototype;p.getShaderReference=function(e,t){var r=this.gl,o=this.shaders[e===r.FRAGMENT_SHADER|0],s=o[t];if(s&&r.isShader(s.shader))s.count+=1;else{var a=i(r,e,t);s=o[t]=new n(h++,t,e,a,[],1,this)}return s},p.getProgram=function(e,t,r,n){var o=[e.id,t.id,r.join(":"),n.join(":")].join("@"),i=this.programs[o];return i&&this.gl.isProgram(i)||(this.programs[o]=i=s(this.gl,e.shader,t.shader,r,n),e.programs.push(o),t.programs.push(o)),i}},{"weakmap-shim":52}],50:[function(e,t,r){function n(){var e={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var r=t.valueOf(e);return r&&r.identity===e?r:o(t,e)}}var o=e("./hidden-store.js");t.exports=n},{"./hidden-store.js":51}],51:[function(e,t,r){function n(e,t){var r={identity:t},n=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?n.apply(this,arguments):r},writable:!0}),r}t.exports=n},{}],52:[function(e,t,r){function n(){var e=o();return{get:function(t,r){var n=e(t);return n.hasOwnProperty("value")?n.value:r},set:function(t,r){e(t).value=r},has:function(t){return"value"in e(t)},"delete":function(t){return delete e(t).value}}}var o=e("./create-store.js");t.exports=n},{"./create-store.js":50}],53:[function(e,t,r){"use strict";function n(e){if(!e)return a;for(var t=0;t<e.args.length;++t){var r=e.args[t];0===t?e.args[t]={name:r,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:e.args[t]={name:r,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function o(e){return s({args:e.args,pre:n(e.pre),body:n(e.body),post:n(e.proc),funcName:e.funcName})}function i(e){for(var t=[],r=0;r<e.args.length;++r)t.push("a"+r);var n=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return n(o(e))}var s=e("cwise-compiler"),a={body:"",args:[],thisVars:[],localVars:[]},l={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in l){var t=l[e];r[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),r[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),r[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),r[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var t=u[e];r[e]=i({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),r[e+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var f={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in f){var t=f[e];r[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),r[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),r[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),r[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<c.length;++e){var t=c[e];r[t]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),r[t+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var e=0;e<h.length;++e){var t=h[e];r[t]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),r[t+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),r[t+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),r[t+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var p=["atan2","pow"];!function(){for(var e=0;e<p.length;++e){var t=p[e];r[t+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),r[t+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),r[t+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),r[t+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),r.any=s({args:["array"],pre:a,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),r.all=s({args:["array"],pre:a,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),r.sum=s({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),r.prod=s({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),r.norm2squared=s({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),r.norm2=s({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),r.norminf=s({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),r.norm1=s({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),r.sup=s({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.inf=s({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.argmin=s({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.argmax=s({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),r.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),r.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),r.equals=s({args:["array","array"],pre:a,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":54}],54:[function(e,t,r){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function o(e){var t=new n;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var o=0;o<r.length;++o){var s=r[o];if("array"===s||"object"==typeof s&&s.blockIndices){if(t.argTypes[o]="array",t.arrayArgs.push(o),t.arrayBlockIndices.push(s.blockIndices?s.blockIndices:0),t.shimArgs.push("array"+o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===s)t.scalarArgs.push(o),t.shimArgs.push("scalar"+o);else if("index"===s){if(t.indexArgs.push(o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===s){if(t.shapeArgs.push(o),o<t.pre.args.length&&t.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<t.post.args.length&&t.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof s||!s.offset)throw new Error("cwise: Unknown argument type "+r[o]);t.argTypes[o]="offset",t.offsetArgs.push({array:s.array,offset:s.offset}),t.offsetArgIndex.push(o)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,i(t)}var i=e("./lib/thunk.js");t.exports=o},{"./lib/thunk.js":56}],55:[function(e,t,r){"use strict";function n(e,t,r){var n,o,i=e.length,s=t.arrayArgs.length,a=t.indexArgs.length>0,l=[],u=[],f=0,c=0;for(n=0;i>n;++n)u.push(["i",n,"=0"].join(""));for(o=0;s>o;++o)for(n=0;i>n;++n)c=f,f=e[n],0===n?u.push(["d",o,"s",n,"=t",o,"p",f].join("")):u.push(["d",o,"s",n,"=(t",o,"p",f,"-s",c,"*t",o,"p",c,")"].join(""));for(l.push("var "+u.join(",")),n=i-1;n>=0;--n)f=e[n],l.push(["for(i",n,"=0;i",n,"<s",f,";++i",n,"){"].join(""));for(l.push(r),n=0;i>n;++n){for(c=f,f=e[n],o=0;s>o;++o)l.push(["p",o,"+=d",o,"s",n].join(""));a&&(n>0&&l.push(["index[",c,"]-=s",c].join("")),l.push(["++index[",f,"]"].join(""))),l.push("}")}return l.join("\n")}function o(e,t,r,o){for(var i=t.length,s=r.arrayArgs.length,a=r.blockSize,l=r.indexArgs.length>0,u=[],f=0;s>f;++f)u.push(["var offset",f,"=p",f].join(""));for(var f=e;i>f;++f)u.push(["for(var j"+f+"=SS[",t[f],"]|0;j",f,">0;){"].join("")),u.push(["if(j",f,"<",a,"){"].join("")),u.push(["s",t[f],"=j",f].join("")),u.push(["j",f,"=0"].join("")),u.push(["}else{s",t[f],"=",a].join("")),u.push(["j",f,"-=",a,"}"].join("")),l&&u.push(["index[",t[f],"]=j",f].join(""));for(var f=0;s>f;++f){for(var c=["offset"+f],h=e;i>h;++h)c.push(["j",h,"*t",f,"p",t[h]].join(""));u.push(["p",f,"=(",c.join("+"),")"].join(""))}u.push(n(t,r,o));for(var f=e;i>f;++f)u.push("}");return u.join("\n")}function i(e){for(var t=0,r=e[0].length;r>t;){for(var n=1;n<e.length;++n)if(e[n][t]!==e[0][t])return t;++t}return t}function s(e,t,r){for(var n=e.body,o=[],i=[],s=0;s<e.args.length;++s){var a=e.args[s];if(!(a.count<=0)){var l=new RegExp(a.name,"g"),u="",f=t.arrayArgs.indexOf(s);switch(t.argTypes[s]){case"offset":var c=t.offsetArgIndex.indexOf(s),h=t.offsetArgs[c];f=h.array,u="+q"+c;case"array":u="p"+f+u;var p="l"+s,d="a"+f;if(0===t.arrayBlockIndices[f])1===a.count?"generic"===r[f]?a.lvalue?(o.push(["var ",p,"=",d,".get(",u,")"].join("")),n=n.replace(l,p),i.push([d,".set(",u,",",p,")"].join(""))):n=n.replace(l,[d,".get(",u,")"].join("")):n=n.replace(l,[d,"[",u,"]"].join("")):"generic"===r[f]?(o.push(["var ",p,"=",d,".get(",u,")"].join("")),n=n.replace(l,p),a.lvalue&&i.push([d,".set(",u,",",p,")"].join(""))):(o.push(["var ",p,"=",d,"[",u,"]"].join("")),n=n.replace(l,p),a.lvalue&&i.push([d,"[",u,"]=",p].join("")));else{for(var g=[a.name],m=[u],v=0;v<Math.abs(t.arrayBlockIndices[f]);v++)g.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(v+1)+"*t"+f+"b"+v);if(l=new RegExp(g.join(""),"g"),u=m.join("+"),"generic"===r[f])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(l,[d,"[",u,"]"].join(""))}break;case"scalar":n=n.replace(l,"Y"+t.scalarArgs.indexOf(s));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape")}}}return[o.join("\n"),n,i.join("\n")].join("\n").trim()}function a(e){for(var t=new Array(e.length),r=!0,n=0;n<e.length;++n){var o=e[n],i=o.match(/\d+/);i=i?i[0]:"",0===o.charAt(0)?t[n]="u"+o.charAt(1)+i:t[n]=o.charAt(0)+i,n>0&&(r=r&&t[n]===t[n-1])}return r?t[0]:t.join("")}function l(e,t){for(var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,l=new Array(e.arrayArgs.length),f=new Array(e.arrayArgs.length),c=0;c<e.arrayArgs.length;++c)f[c]=t[2*c],l[c]=t[2*c+1];for(var h=[],p=[],d=[],g=[],m=[],c=0;c<e.arrayArgs.length;++c){e.arrayBlockIndices[c]<0?(d.push(0),g.push(r),h.push(r),p.push(r+e.arrayBlockIndices[c])):(d.push(e.arrayBlockIndices[c]),g.push(e.arrayBlockIndices[c]+r),h.push(0),p.push(e.arrayBlockIndices[c]));for(var v=[],_=0;_<l[c].length;_++)d[c]<=l[c][_]&&l[c][_]<g[c]&&v.push(l[c][_]-d[c]);m.push(v)}for(var y=["SS"],b=["'use strict'"],x=[],_=0;r>_;++_)x.push(["s",_,"=SS[",_,"]"].join(""));for(var c=0;c<e.arrayArgs.length;++c){y.push("a"+c),y.push("t"+c),y.push("p"+c);for(var _=0;r>_;++_)x.push(["t",c,"p",_,"=t",c,"[",d[c]+_,"]"].join(""));for(var _=0;_<Math.abs(e.arrayBlockIndices[c]);++_)x.push(["t",c,"b",_,"=t",c,"[",h[c]+_,"]"].join(""))}for(var c=0;c<e.scalarArgs.length;++c)y.push("Y"+c);if(e.shapeArgs.length>0&&x.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var w=new Array(r),c=0;r>c;++c)w[c]="0";x.push(["index=[",w.join(","),"]"].join(""))}for(var c=0;c<e.offsetArgs.length;++c){for(var E=e.offsetArgs[c],T=[],_=0;_<E.offset.length;++_)0!==E.offset[_]&&(1===E.offset[_]?T.push(["t",E.array,"p",_].join("")):T.push([E.offset[_],"*t",E.array,"p",_].join("")));0===T.length?x.push("q"+c+"=0"):x.push(["q",c,"=",T.join("+")].join(""))}var C=u([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));x=x.concat(C),b.push("var "+x.join(","));for(var c=0;c<e.arrayArgs.length;++c)b.push("p"+c+"|=0");e.pre.body.length>3&&b.push(s(e.pre,e,f));var A=s(e.body,e,f),D=i(m);r>D?b.push(o(D,m[0],e,A)):b.push(n(m[0],e,A)),e.post.body.length>3&&b.push(s(e.post,e,f)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+b.join("\n")+"\n----------");var S=[e.funcName||"unnamed","_cwise_loop_",l[0].join("s"),"m",D,a(f)].join(""),R=new Function(["function ",S,"(",y.join(","),"){",b.join("\n"),"} return ",S].join(""));return R()}var u=e("uniq");t.exports=l},{uniq:57}],56:[function(e,t,r){"use strict";function n(e){var t=["'use strict'","var CACHED={}"],r=[],n=e.funcName+"_cwise_thunk";t.push(["return function ",n,"(",e.shimArgs.join(","),"){"].join(""));for(var i=[],s=[],a=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],l=[],u=[],f=0;f<e.arrayArgs.length;++f){var c=e.arrayArgs[f];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),i.push("t"+c),i.push("r"+c),s.push("t"+c),s.push("r"+c+".join()"),a.push("array"+c+".data"),a.push("array"+c+".stride"),a.push("array"+c+".offset|0"),f>0&&(l.push("array"+e.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[f]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[f])+"]"))}e.arrayArgs.length>1&&(t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var f=0;f<e.scalarArgs.length;++f)a.push("scalar"+e.scalarArgs[f]);r.push(["type=[",s.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),t.push("var "+r.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",a.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var h=new Function("compile",t.join("\n"));return h(o.bind(void 0,e))}var o=e("./compile.js");t.exports=n},{"./compile.js":55}],57:[function(e,t,r){"use strict";function n(e,t){for(var r=1,n=e.length,o=e[0],i=e[0],s=1;n>s;++s)if(i=o,o=e[s],t(o,i)){if(s===r){r++;continue}e[r++]=o}return e.length=r,e}function o(e){for(var t=1,r=e.length,n=e[0],o=e[0],i=1;r>i;++i,o=n)if(o=n,n=e[i],n!==o){if(i===t){t++;continue}e[t++]=n}return e.length=t,e}function i(e,t,r){return 0===e.length?e:t?(r||e.sort(t),n(e,t)):(r||e.sort(),o(e))}t.exports=i},{}],58:[function(e,t,r){"use strict";"use restrict";function n(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var o=32;r.INT_BITS=o,r.INT_MAX=2147483647,r.INT_MIN=-1<<o-1,r.sign=function(e){return(e>0)-(0>e)},r.abs=function(e){var t=e>>o-1;return(e^t)-t},r.min=function(e,t){return t^(e^t)&-(t>e)},r.max=function(e,t){return e^(e^t)&-(t>e)},r.isPow2=function(e){return!(e&e-1||!e)},r.log2=function(e){var t,r;return t=(e>65535)<<4,e>>>=t,r=(e>255)<<3,e>>>=r,t|=r,r=(e>15)<<2,e>>>=r,t|=r,r=(e>3)<<1,e>>>=r,t|=r,t|e>>1},r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},r.popCount=function(e){return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},r.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},r.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var i=new Array(256);!function(e){for(var t=0;256>t;++t){var r=t,n=t,o=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--o;e[t]=n<<o&255}}(i),r.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},r.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},r.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},r.interleave3=function(e,t,r){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),e|r<<2},r.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},{}],59:[function(e,t,r){"use strict";function n(e,t,r){var o=0|e[r];if(0>=o)return[];var i,s=new Array(o);if(r===e.length-1)for(i=0;o>i;++i)s[i]=t;else for(i=0;o>i;++i)s[i]=n(e,t,r+1);return s}function o(e,t){var r,n;for(r=new Array(e),n=0;e>n;++n)r[n]=t;return r}function i(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(e>0)return o(0|e,t);break;case"object":if("number"==typeof e.length)return n(e,t,0)}return[]}t.exports=i},{}],60:[function(e,t,r){(function(t,n){"use strict";function o(e){if(e){var t=e.length||e.byteLength,r=_.log2(t);w[r].push(e)}}function i(e){o(e.buffer)}function s(e){var e=_.nextPow2(e),t=_.log2(e),r=w[t];return r.length>0?r.pop():new ArrayBuffer(e)}function a(e){return new Uint8Array(s(e),0,e)}function l(e){return new Uint16Array(s(2*e),0,e)}function u(e){return new Uint32Array(s(4*e),0,e)}function f(e){return new Int8Array(s(e),0,e)}function c(e){return new Int16Array(s(2*e),0,e)}function h(e){return new Int32Array(s(4*e),0,e)}function p(e){return new Float32Array(s(4*e),0,e)}function d(e){return new Float64Array(s(8*e),0,e)}function g(e){return b?new Uint8ClampedArray(s(e),0,e):a(e)}function m(e){return new DataView(s(e),0,e)}function v(e){e=_.nextPow2(e);var t=_.log2(e),r=E[t];return r.length>0?r.pop():new n(e)}var _=e("bit-twiddle"),y=e("dup");t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:y([32,0]),UINT16:y([32,0]),UINT32:y([32,0]),INT8:y([32,0]),INT16:y([32,0]),INT32:y([32,0]),FLOAT:y([32,0]),DOUBLE:y([32,0]),DATA:y([32,0]),UINT8C:y([32,0]),BUFFER:y([32,0])});var b="undefined"!=typeof Uint8ClampedArray,x=t.__TYPEDARRAY_POOL;x.UINT8C||(x.UINT8C=y([32,0])),x.BUFFER||(x.BUFFER=y([32,0]));var w=x.DATA,E=x.BUFFER;r.free=function(e){if(n.isBuffer(e))E[_.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,r=0|_.log2(t);w[r].push(e)}},r.freeUint8=r.freeUint16=r.freeUint32=r.freeInt8=r.freeInt16=r.freeInt32=r.freeFloat32=r.freeFloat=r.freeFloat64=r.freeDouble=r.freeUint8Clamped=r.freeDataView=i,
r.freeArrayBuffer=o,r.freeBuffer=function(e){E[_.log2(e.length)].push(e)},r.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return s(e);switch(t){case"uint8":return a(e);case"uint16":return l(e);case"uint32":return u(e);case"int8":return f(e);case"int16":return c(e);case"int32":return h(e);case"float":case"float32":return p(e);case"double":case"float64":return d(e);case"uint8_clamped":return g(e);case"buffer":return v(e);case"data":case"dataview":return m(e);default:return null}return null},r.mallocArrayBuffer=s,r.mallocUint8=a,r.mallocUint16=l,r.mallocUint32=u,r.mallocInt8=f,r.mallocInt16=c,r.mallocInt32=h,r.mallocFloat32=r.mallocFloat=p,r.mallocFloat64=r.mallocDouble=d,r.mallocUint8Clamped=g,r.mallocDataView=m,r.mallocBuffer=v,r.clearCache=function(){for(var e=0;32>e;++e)x.UINT8[e].length=0,x.UINT16[e].length=0,x.UINT32[e].length=0,x.INT8[e].length=0,x.INT16[e].length=0,x.INT32[e].length=0,x.FLOAT[e].length=0,x.DOUBLE[e].length=0,x.UINT8C[e].length=0,w[e].length=0,E[e].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"bit-twiddle":58,buffer:1,dup:59}],61:[function(e,t,r){"use strict";function n(e){m=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],v=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],_=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function o(e,t,r){var n=e.gl,o=n.getParameter(n.MAX_TEXTURE_SIZE);if(0>t||t>o||0>r||r>o)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,r],e.bind(),n.texImage2D(n.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null),e._mipLevels=[0],e}function i(e,t,r,n,o,i){this.gl=e,this.handle=t,this.format=o,this.type=i,this._shape=[r,n],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var s=this,a=[this._wrapS,this._wrapT];Object.defineProperties(a,[{get:function(){return s._wrapS},set:function(e){return s.wrapS=e}},{get:function(){return s._wrapT},set:function(e){return s.wrapT=e}}]),this._wrapVector=a;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return s._shape[0]},set:function(e){return s.width=e}},{get:function(){return s._shape[1]},set:function(e){return s.height=e}}]),this._shapeVector=l}function s(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function a(e,t,r,n,o,i,a,l){var u=l.dtype,f=l.shape.slice();if(f.length<2||f.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var c=0,h=0,m=s(f,l.stride.slice());"float32"===u?c=e.FLOAT:"float64"===u?(c=e.FLOAT,m=!1,u="float32"):"uint8"===u?c=e.UNSIGNED_BYTE:(c=e.UNSIGNED_BYTE,m=!1,u="uint8");var v=1;if(2===f.length)h=e.LUMINANCE,f=[f[0],f[1],1],l=p(l.data,f,[l.stride[0],l.stride[1],1],l.offset);else{if(3!==f.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===f[2])h=e.ALPHA;else if(2===f[2])h=e.LUMINANCE_ALPHA;else if(3===f[2])h=e.RGB;else{if(4!==f[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");h=e.RGBA}v=f[2]}if(h!==e.LUMINANCE&&h!==e.ALPHA||o!==e.LUMINANCE&&o!==e.ALPHA||(h=o),h!==o)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var _=l.size,b=a.indexOf(n)<0;if(b&&a.push(n),c===i&&m)0===l.offset&&l.data.length===_?b?e.texImage2D(e.TEXTURE_2D,n,o,f[0],f[1],0,o,i,l.data):e.texSubImage2D(e.TEXTURE_2D,n,t,r,f[0],f[1],o,i,l.data):b?e.texImage2D(e.TEXTURE_2D,n,o,f[0],f[1],0,o,i,l.data.subarray(l.offset,l.offset+_)):e.texSubImage2D(e.TEXTURE_2D,n,t,r,f[0],f[1],o,i,l.data.subarray(l.offset,l.offset+_));else{var x;x=i===e.FLOAT?g.mallocFloat32(_):g.mallocUint8(_);var w=p(x,f,[f[2],f[2]*f[0],1]);c===e.FLOAT&&i===e.UNSIGNED_BYTE?y(w,l):d.assign(w,l),b?e.texImage2D(e.TEXTURE_2D,n,o,f[0],f[1],0,o,i,x.subarray(0,_)):e.texSubImage2D(e.TEXTURE_2D,n,t,r,f[0],f[1],o,i,x.subarray(0,_)),i===e.FLOAT?g.freeFloat32(x):g.freeUint8(x)}}function l(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function u(e,t,r,n,o){var s=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>t||t>s||0>r||r>s)throw new Error("gl-texture2d: Invalid texture shape");if(o===e.FLOAT&&!e.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var a=l(e);return e.texImage2D(e.TEXTURE_2D,0,n,t,r,0,n,o,null),new i(e,a,t,r,n,o)}function f(e,t,r,n){var o=l(e);return e.texImage2D(e.TEXTURE_2D,0,r,r,n,t),new i(e,o,0|t.width,0|t.height,r,n)}function c(e,t){var r=t.dtype,n=t.shape.slice(),o=e.getParameter(e.MAX_TEXTURE_SIZE);if(n[0]<0||n[0]>o||n[1]<0||n[1]>o)throw new Error("gl-texture2d: Invalid texture size");var a=s(n,t.stride.slice()),u=0;"float32"===r?u=e.FLOAT:"float64"===r?(u=e.FLOAT,a=!1,r="float32"):"uint8"===r?u=e.UNSIGNED_BYTE:(u=e.UNSIGNED_BYTE,a=!1,r="uint8");var f=0;if(2===n.length)f=e.LUMINANCE,n=[n[0],n[1],1],t=p(t.data,n,[t.stride[0],t.stride[1],1],t.offset);else{if(3!==n.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===n[2])f=e.ALPHA;else if(2===n[2])f=e.LUMINANCE_ALPHA;else if(3===n[2])f=e.RGB;else{if(4!==n[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");f=e.RGBA}}u!==e.FLOAT||e.getExtension("OES_texture_float")||(u=e.UNSIGNED_BYTE,a=!1);var c,h,m=t.size;if(a)c=0===t.offset&&t.data.length===m?t.data:t.data.subarray(t.offset,t.offset+m);else{var v=[n[2],n[2]*n[0],1];h=g.malloc(m,r);var _=p(h,n,v,0);"float32"!==r&&"float64"!==r||u!==e.UNSIGNED_BYTE?d.assign(_,t):y(_,t),c=h.subarray(0,m)}var b=l(e);return e.texImage2D(e.TEXTURE_2D,0,f,n[0],n[1],0,f,u,c),a||g.free(h),new i(e,b,n[0],n[1],f,u)}function h(e){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(m||n(e),"number"==typeof arguments[1])return u(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return u(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1];if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof ImageData)return f(e,t,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return c(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var p=e("ndarray"),d=e("ndarray-ops"),g=e("typedarray-pool");t.exports=h;var m=null,v=null,_=null,y=function(e,t){d.muls(e,t,255)},b=i.prototype;Object.defineProperties(b,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&m.indexOf(e)>=0&&(t.getExtension("OES_texture_float_linear")||(e=t.NEAREST)),v.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&m.indexOf(e)>=0&&(t.getExtension("OES_texture_float_linear")||(e=t.NEAREST)),v.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|Math.max(e,1),t!==this._anisoSamples){var r=gl.getExtension("EXT_texture_filter_anisotropic");r&&this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),_.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),_.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;2>t;++t)if(_.indexOf(e[t])<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var r=this.gl;return this.bind(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(Array.isArray(e)){if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape")}else e=[0|e,0|e];return o(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e=0|e,o(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e=0|e,o(this,this._shape[0],e),e}}}),b.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0!==e?0|e:t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0},b.dispose=function(){this.gl.deleteTexture(this.handle)},b.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=Math.min(this._shape[0],this._shape[1]),t=0;e>0;++t,e>>>=1)this._mipLevels.indexOf(t)<0&&this._mipLevels.push(t)},b.setPixels=function(e,t,r,n){var o=this.gl;if(this.bind(),Array.isArray(t)?(n=r,r=0|t[1],t=0|t[0]):(t=t||0,r=r||0),n=n||0,e instanceof HTMLCanvasElement||e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLVideoElement){var i=this._mipLevels.indexOf(n)<0;i?(o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,this.type,e),this._mipLevels.push(n)):o.texSubImage2D(o.TEXTURE_2D,n,t,r,this.format,this.type,e)}else{if(!(e.shape&&e.stride&&e.data))throw new Error("gl-texture2d: Unsupported data type");if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>n||r+e.shape[0]>this._shape[0]>>>n||0>t||0>r)throw new Error("gl-texture2d: Texture dimensions are out of bounds");a(o,t,r,n,this.format,this.type,this._mipLevels,e)}}},{ndarray:67,"ndarray-ops":53,"typedarray-pool":60}],62:[function(e,t,r){t.exports={glsl:"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 resolution;uniform sampler2D from, to;uniform float progress;void main() {vec2 p = gl_FragCoord.xy / resolution;gl_FragColor = mix(texture2D(from, p), texture2D(to, p), progress);}",uniforms:{},id:"7e61b1f44a391f0c0894",name:"fade",owner:"glslioadmin",html_url:"https://gist.github.com/glslioadmin/7e61b1f44a391f0c0894",created_at:"2014-05-16T00:00:00Z",updated_at:"2014-05-16T00:00:00Z",stars:0}},{}],63:[function(e,t,r){function n(e,t){return this instanceof n?(this.gl=e,this.shader=o(e,i,t),void(this.buffer=e.createBuffer())):new n(e,t)}var o=e("gl-shader"),i="attribute vec2 position; void main() { gl_Position = vec4(2.0*position-1.0, 0.0, 1.0);}";t.exports=n,n.prototype={dispose:function(){this.shader.dispose(),this.gl.deleteBuffer(this.buffer),this.shader=null,this.buffer=null},render:function(e,t,r,n){var o=this.gl,i=this.shader,s=0;i.bind(),this._checkViewport(),i.uniforms.progress=e,i.uniforms.from=t.bind(s++),i.uniforms.to=r.bind(s++);for(var a in n){var l=n[a];l&&l.bind?i.uniforms[a]=l.bind(s++):i.uniforms[a]!==l&&(i.uniforms[a]=l)}o.drawArrays(o.TRIANGLES,0,6)},_checkViewport:function(){var e=this.gl,t=e.canvas,r=t.width,n=t.height;(this._w!==r||this._h!==n)&&(this._syncViewport(r,n),this._w=r,this._h=n)},_syncViewport:function(e,t){var r=this.gl,n=this.shader,o=this.buffer,i=0,s=e,a=0,l=t;n.uniforms.resolution=new Float32Array([e,t]),r.bindBuffer(r.ARRAY_BUFFER,o),n.attributes.position.pointer(),r.bufferData(r.ARRAY_BUFFER,new Float32Array([i,a,s,a,i,l,i,l,s,a,s,l]),r.STATIC_DRAW),r.viewport(i,a,s,l)}}},{"gl-shader":44}],64:[function(e,t,r){function n(e){this.elt=e,"absolute"!==e.style.position&&(e.style.position="relative"),e.style.overflow="hidden"}var o=e("vendor-prefix"),i=o("transform"),s=o("transform-origin");n.prototype={clamped:!0,rgb:[0,0,0],getViewport:function(){return this.elt.getBoundingClientRect()},abort:function(){this.reset()},_transformForRect:function(e){var t=this.getViewport(),r=t.width/e[2],n=[-e[0]+"px",-e[1]+"px"];return"scale("+r+") translate("+n+")"},_reset:function(){this.elt.style.backgroundColor="rgb("+this.rgb.map(function(e){return 255*e})+")",this.elt.innerHTML=""},_setImage:function(e){e!==this.image&&(this._reset(),this.elt.appendChild(e),e.style.position="absolute",e.style.top=0,e.style.left=0,e.style[s]="0% 0%",this.image=e)},_positionImage:function(e){this.image.style[i]=this._transformForRect(e)},runStart:function(e){this._setImage(e)},draw:function(e,t){this._positionImage(t)}},t.exports=n},{"vendor-prefix":65}],65:[function(e,t,r){"use strict";function n(e){return e in f?f[e]:f[e]=o(e)}function o(e){var t,r=e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}),n=l.length;if(void 0!==a[r])return r;for(r=i(e);n--;)if(t=l[n]+r,void 0!==a[t])return t;throw new Error("unable to prefix "+e)}function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}function s(e){var t=n(e),r=/([A-Z])/g;return r.test(t)&&(t=(u.test(t)?"-":"")+t.replace(r,"-$1")),t.toLowerCase()}var a=document.createElement("p").style,l="O ms Moz webkit".split(" "),u=/^(o|ms|moz|webkit)/,f={};t.exports=n,t.exports.dash=s},{}],66:[function(e,t,r){function n(e){return this instanceof n?(this.gl=e,this.shader=o(e,"#define GLSLIFY 1\nvarying vec2 uv;\n\nattribute vec2 p;\n\nuniform vec2 imgRes; // image size\nuniform vec2 pos; // bound position\nuniform vec2 dim; // bound size\n\nvoid main() {\n  uv = pos/imgRes + ((p * vec2(1.,-1.)+1.)/2.) * (dim/imgRes);\n  gl_Position = vec4(p,0.,1.);\n}\n","#define GLSLIFY 1\nprecision highp float;\n\nvarying vec2 uv;\n\nuniform sampler2D img;\nuniform vec3 bg;\n\nvoid main() {\n  if(uv.x<0.||uv.x>1.||uv.y<0.||uv.y>1.)\n    gl_FragColor = vec4(bg, 1.0);\n  else\n    gl_FragColor = texture2D(img, uv);\n}\n"),this.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),void e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW)):new n(e)}var o=e("gl-shader");n.prototype={clamped:!0,rgb:[0,0,0],dispose:function(){this.shader.dispose(),this.gl.deleteBuffer(this.buffer),this.gl=null,this.shader=null,this.buffer=null},render:function(e,t){var r=t[0],n=t[1],o=t[2],i=t[3];if(isNaN(r)||isNaN(n)||isNaN(o)||isNaN(i))throw new Error("invalid numbers in bound: "+t);var s=this.gl,a=this.shader;a.bind(),s.bindBuffer(s.ARRAY_BUFFER,this.buffer),a.attributes.p.pointer(),a.uniforms.imgRes=e.shape.slice(0,2),a.uniforms.bg=this.rgb,a.uniforms.img=e.bind(),a.uniforms.pos=[r,n],a.uniforms.dim=[o,i],s.drawArrays(s.TRIANGLES,0,6)},getViewport:function(){return{width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight}}},t.exports=n},{"gl-shader":44}],67:[function(e,t,r){function n(e,t){return e[0]-t[0]}function o(){var e,t=this.stride,r=new Array(t.length);for(e=0;e<r.length;++e)r[e]=[Math.abs(t[e]),e];r.sort(n);var o=new Array(r.length);for(e=0;e<o.length;++e)o[e]=r[e][1];return o}function i(e,t){var r=["View",t,"d",e].join("");0>t&&(r="View_Nil"+e);var n="generic"===e;if(-1===t){var i="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}",s=new Function(i);return s()}if(0===t){var i="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",s=new Function("TrivialArray",i);return s(c[e][0])}var i=["'use strict'"],a=l(t),u=a.map(function(e){return"i"+e}),f="this.offset+"+a.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),h=a.map(function(e){return"b"+e}).join(","),p=a.map(function(e){return"c"+e}).join(",");i.push("function "+r+"(a,"+h+","+p+",d){this.data=a","this.shape=["+h+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),i.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+a.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),4>t?(i.push("function "+r+"_order(){"),2===t?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+r+"_set("+u.join(",")+",v){"),n?i.push("return this.data.set("+f+",v)}"):i.push("return this.data["+f+"]=v}"),i.push("proto.get=function "+r+"_get("+u.join(",")+"){"),n?i.push("return this.data.get("+f+")}"):i.push("return this.data["+f+"]}"),i.push("proto.index=function "+r+"_index(",u.join(),"){return "+f+"}"),i.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+a.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+a.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var d=a.map(function(e){return"a"+e+"=this.shape["+e+"]"}),g=a.map(function(e){return"c"+e+"=this.stride["+e+"]"});i.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+g.join(","));for(var m=0;t>m;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");i.push("return new "+r+"(this.data,"+a.map(function(e){return"a"+e}).join(",")+","+a.map(function(e){return"c"+e}).join(",")+",b)}"),i.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+a.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+a.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;t>m;++m)i.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");i.push("return new "+r+"(this.data,"+a.map(function(e){return"a"+e}).join(",")+","+a.map(function(e){return"b"+e}).join(",")+",c)}");for(var v=new Array(t),_=new Array(t),m=0;t>m;++m)v[m]="a[i"+m+"]",_[m]="b[i"+m+"]";i.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+v.join(",")+","+_.join(",")+",this.offset)}"),i.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var m=0;t>m;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+a.map(function(e){return"shape["+e+"]"}).join(",")+","+a.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",i.join("\n"));return s(c[e],o)}function s(e){if(u(e))return"buffer";if(f)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}function a(e,t,r,n){if(void 0===e){var o=c.array[0];return o([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===r){r=new Array(a);for(var l=a-1,u=1;l>=0;--l)r[l]=u,u*=t[l]}if(void 0===n){n=0;for(var l=0;a>l;++l)r[l]<0&&(n-=(t[l]-1)*r[l])}for(var f=s(e),h=c[f];h.length<=a+1;)h.push(i(f,h.length-1));var o=h[a+1];return o(e,t,r,n)}var l=e("iota-array"),u=e("is-buffer"),f="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=a},{"iota-array":68,"is-buffer":69}],68:[function(e,t,r){"use strict";function n(e){for(var t=new Array(e),r=0;e>r;++r)t[r]=r;return t}t.exports=n},{}],69:[function(e,t,r){t.exports=function(e){return!(null==e||!e.constructor||"function"!=typeof e.constructor.isBuffer||!e.constructor.isBuffer(e))}},{}],70:[function(e,t,r){"use strict";function n(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e,t){for(var r,o,i=n(e),s=1;s<arguments.length;s++){r=arguments[s],o=Object.keys(Object(r));for(var a=0;a<o.length;a++)i[o[a]]=r[o[a]]}return i}},{}],71:[function(e,t,r){for(var n=e("performance-now"),o="undefined"==typeof window?{}:window,i=["moz","webkit"],s="AnimationFrame",a=o["request"+s],l=o["cancel"+s]||o["cancelRequest"+s],u=!0,f=0;f<i.length&&!a;f++)a=o[i[f]+"Request"+s],l=o[i[f]+"Cancel"+s]||o[i[f]+"CancelRequest"+s];if(!a||!l){u=!1;var c=0,h=0,p=[],d=1e3/60;a=function(e){if(0===p.length){var t=n(),r=Math.max(0,d-(t-c));c=r+t,setTimeout(function(){var e=p.slice(0);p.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(c)}catch(r){setTimeout(function(){throw r},0)}},Math.round(r))}return p.push({handle:++h,callback:e,cancelled:!1}),h},l=function(e){for(var t=0;t<p.length;t++)p[t].handle===e&&(p[t].cancelled=!0)}}t.exports=function(e){return u?a.call(o,function(){try{e.apply(this,arguments)}catch(t){setTimeout(function(){throw t},0)}}):a.call(o,e)},t.exports.cancel=function(){l.apply(o,arguments)}},{"performance-now":72}],72:[function(e,t,r){(function(e){(function(){var r,n,o;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(r()-o)/1e6},n=e.hrtime,r=function(){var e;return e=n(),1e9*e[0]+e[1]},o=r()):Date.now?(t.exports=function(){return Date.now()-o},o=Date.now()):(t.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,e("_process"))},{_process:6}],73:[function(e,t,r){t.exports=function(e,t){var r=e[2],n=e[3],o=t[2],i=t[3],s=r/n;return r>o&&(r=o,n=~~(r/s)),n>i&&(n=i,r=~~(n*s)),[t[0]+Math.max(0,Math.min(e[0],o-r)),t[1]+Math.max(0,Math.min(e[1],i-n)),r,n]}},{}],74:[function(e,t,r){function n(e,t){return t||(t=[.5,.5]),function(r,n){var o=r.width/r.height,i=n.width/n.height,s=Math.max(o,i),a=[o/s*n.width*e,i/s*n.height*e];return[n.width*t[0]-a[0]/2,n.height*t[1]-a[1]/2,a[0],a[1]]}}n.largest=n(1),t.exports=n},{}],75:[function(e,t,r){function n(e,t,r){return e*(1-r)+t*r}t.exports=function(e,t,r){for(var o=[],i=0;4>i;++i)o[i]=n(e[i],t[i],r);return o}},{}],76:[function(e,t,r){function n(e,t){var r=Error.call(this,e);this.name=r.name="UnsupportedDrawOperation",this.stack=r.stack,this.message=r.message,this.path=t}function o(e){if(e in this._imgs)return this._imgs[e];var t=new window.Image;return t.crossOrigin=!0,t.src=e,this._imgs[e]=t,t.onload=this.flush.bind(this),t}function i(e,t){return this instanceof i?(this.ctx=e,this._imgs={},void(this.resolveImage=t||o)):new i(e,t)}var s=e("draw-image-normalized"),a=e("rect-crop"),l={background:"#000",size:[1e3,1e3],draws:[]};n.prototype=Object.create(Error.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i.defaultResolveImage=o,i.defaults=l,i.prototype={destroy:function(){this._item=null,this._imgs=null,this.ctx=null},getSize:function(e){return e.size||l.size},getRectangle:function(e){var t=this.getSize(e),r=t[0],n=t[1];return a.largest({width:r,height:n},this.ctx.canvas)},flush:function(){this._item&&this.render(this._item)},render:function(e,t){this._item=e;var r=this.ctx,n=r.canvas,o=n.width,i=n.height,s=e.background||l.size,a=this.getSize(e),u=this.getRectangle(e),f=a[0],c=a[1];r.save(),r.fillStyle=s,r.fillRect(0,0,o,i),r.translate(Math.round(u[0]),Math.round(u[1])),r.scale(u[2]/f,u[3]/c),this._renderRec(e.draws||l.draws,[],t||function(){}),r.restore()},_renderRec:function(e,t,r){for(var n=this.ctx,o=e.length,i=0;o>i;++i){var s=e[i],a=t.concat([i]);if(s instanceof Array){var l=s[0];"object"==typeof l?(n.save(),this._renderRec(s,a,r),n.restore()):this._renderOp(l,s.slice(1),a)}else for(var u in s)n[u]=s[u];r(a,s)}},_renderOp:function(e,t,r){var o=this.ctx;if("string"!=typeof e)throw new n("must be a string operation: "+e,r);switch(e){case"drawImage":var i="string"==typeof t[0]?this.resolveImage(t[0]):i;s.apply(null,[o,i].concat(t.slice(1)));break;case"fillText":case"strokeText":var a=t[0],l=a.split("\n"),u=l.length,f=t[1],c=t[2];if(1===u||t.length<4)o[e].call(o,a,f,c);else for(var h=t[3],p=0;u>p;++p)o[e].call(o,l[p],f,c+p*h);break;default:var d=o[e];if("function"!=typeof d)throw new n(e,r);d.apply(o,t)}}},t.exports=i},{"draw-image-normalized":77,"rect-crop":74}],77:[function(e,t,r){t.exports=function(e,t,r,n,o,i,s,a,l,u){if(arguments.length<=6&&(s=r,a=n,l=o,u=i,r=0,n=0,o=t.width,i=t.height),arguments.length<=4&&(l=o,u=i),0>r&&(s-=r*l/o,l+=r*l/o,o+=r,r=0),0>n&&(a-=n*u/i,u+=n*u/i,i+=n,n=0),r+o>t.width){var f=r+o-t.width;l*=(o-f)/o,o=t.width}if(n+i>t.height){var c=n+i-t.height;u*=(i-c)/i,i=t.height}0>=o||0>=i||0>=l||0>=u||e.drawImage.apply(e,[t,r,n,o,i,s,a,l,u])}},{}],78:[function(e,t,r){!function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function r(e){return!(e.substr(0,p.length)==p&&"___"===e.substr(e.length-3))}function n(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[d];if(t&&t.key===e)return t;if(!h(e))return void 0;t={key:e};try{return c(e,d,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(r){return void 0}}function o(e){return e.prototype=null,Object.freeze(e)}function i(){_||"undefined"==typeof console||(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e);var s=!1;if("function"==typeof WeakMap){var a=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var l=new a,u=Object.freeze({});if(l.set(u,1),1===l.get(u))return void(t.exports=WeakMap);s=!0}}var f=(Object.prototype.hasOwnProperty,Object.getOwnPropertyNames),c=Object.defineProperty,h=Object.isExtensible,p="weakmap:",d=p+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var g=new ArrayBuffer(25),m=new Uint8Array(g);crypto.getRandomValues(m),d=p+"rand:"+Array.prototype.map.call(m,function(e){return(e%36).toString(36)}).join("")+"___"}if(c(Object,"getOwnPropertyNames",{value:function(e){return f(e).filter(r)}}),"getPropertyNames"in Object){var v=Object.getPropertyNames;c(Object,"getPropertyNames",{value:function(e){return v(e).filter(r)}})}!function(){var e=Object.freeze;c(Object,"freeze",{value:function(t){return n(t),e(t)}});var t=Object.seal;c(Object,"seal",{value:function(e){return n(e),t(e)}});var r=Object.preventExtensions;c(Object,"preventExtensions",{value:function(e){return n(e),r(e)}})}();var _=!1,y=0,b=function(){function e(e,t){var r,o=n(e);return o?u in o?o[u]:t:(r=a.indexOf(e),r>=0?l[r]:t)}function t(e){var t=n(e);return t?u in t:a.indexOf(e)>=0}function r(e,t){var r,o=n(e);return o?o[u]=t:(r=a.indexOf(e),r>=0?l[r]=t:(r=a.length,l[r]=t,a[r]=e)),this}function s(e){var t,r,o=n(e);return o?u in o&&delete o[u]:(t=a.indexOf(e),0>t?!1:(r=a.length-1,a[t]=void 0,l[t]=l[r],a[t]=a[r],a.length=r,l.length=r,!0))}this instanceof b||i();var a=[],l=[],u=y++;return Object.create(b.prototype,{get___:{value:o(e)},has___:{value:o(t)},set___:{value:o(r)},delete___:{value:o(s)}})};b.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},"delete":{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof a?!function(){function r(){function t(e,t){return f?u.has(e)?u.get(e):f.get___(e,t):u.get(e,t)}function r(e){return u.has(e)||(f?f.has___(e):!1)}function n(e){var t=!!u["delete"](e);return f?f.delete___(e)||t:t}this instanceof b||i();var l,u=new a,f=void 0,c=!1;return l=s?function(e,t){return u.set(e,t),u.has(e)||(f||(f=new b),f.set(e,t)),this}:function(e,t){if(c)try{u.set(e,t)}catch(r){f||(f=new b),f.set___(e,t)}else u.set(e,t);return this},Object.create(b.prototype,{get___:{value:o(t)},has___:{value:o(r)},set___:{value:o(l)},delete___:{value:o(n)},permitHostObjects___:{value:o(function(t){if(t!==e)throw new Error("bogus call to permitHostObjects___");c=!0})}})}s&&"undefined"!=typeof Proxy&&(Proxy=void 0),r.prototype=b.prototype,t.exports=r,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),t.exports=b)}}()},{}],79:[function(e,t,r){"use strict";function n(e){return e.replace(/^[A-Z]+_/,"")}function o(e){var t=s.get(e);if(t)return t;for(var r={},o=e.getSupportedExtensions(),i=0;i<o.length;++i){var a=o[i];if(0!==a.indexOf("MOZ_")){var l=e.getExtension(o[i]);if(l)for(;;){r[a]=l;var u=n(a);if(u===a)break;a=u}}}return s.set(e,r),r}var i="undefined"==typeof WeakMap?e("weak-map"):WeakMap,s=new i;t.exports=o},{"weak-map":78}]},{},[8]);
